<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Windwos批处理教程及实用命令 | Gxkon's Blog</title><meta name="description" content="Windwos批处理bat教程及实用命令一、教程1.1 参考网络上的教程超详细批处理教程！批处理 for参数之token详解百度百科 批处理菜鸟教程 批处理之家  想知道批处理某个命令的意思，就在CMD中输入【XX&#x2F;?】即可 比如：“ for &#x2F;? ”  1.2 简单介绍 批处理就是一种脚本，可以简单也可以复杂的，自动化执行命令，提高效率   echo off 命令确保执行代码时不显示命令 ech"><meta name="keywords" content="BAT批处理"><meta name="author" content="Gkon"><meta name="copyright" content="Gkon"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Windwos批处理教程及实用命令"><meta name="twitter:description" content="Windwos批处理bat教程及实用命令一、教程1.1 参考网络上的教程超详细批处理教程！批处理 for参数之token详解百度百科 批处理菜鸟教程 批处理之家  想知道批处理某个命令的意思，就在CMD中输入【XX&#x2F;?】即可 比如：“ for &#x2F;? ”  1.2 简单介绍 批处理就是一种脚本，可以简单也可以复杂的，自动化执行命令，提高效率   echo off 命令确保执行代码时不显示命令 ech"><meta name="twitter:image" content="https://tvax4.sinaimg.cn/large/4a9e9735gy1gdx2kud32xj20zk0qoaly.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Windwos批处理教程及实用命令"><meta property="og:url" content="http://gxkon.top/posts/1684f4d3/"><meta property="og:site_name" content="Gxkon's Blog"><meta property="og:description" content="Windwos批处理bat教程及实用命令一、教程1.1 参考网络上的教程超详细批处理教程！批处理 for参数之token详解百度百科 批处理菜鸟教程 批处理之家  想知道批处理某个命令的意思，就在CMD中输入【XX&#x2F;?】即可 比如：“ for &#x2F;? ”  1.2 简单介绍 批处理就是一种脚本，可以简单也可以复杂的，自动化执行命令，提高效率   echo off 命令确保执行代码时不显示命令 ech"><meta property="og:image" content="https://tvax4.sinaimg.cn/large/4a9e9735gy1gdx2kud32xj20zk0qoaly.jpg"><meta property="article:published_time" content="2020-04-17T12:18:54.000Z"><meta property="article:modified_time" content="2020-09-29T06:37:29.856Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://gxkon.top/posts/1684f4d3/"><link rel="prev" title="斐讯N1刷各种系统" href="http://gxkon.top/posts/ab31d935/"><link rel="next" title="注册表和BAT批处理修改IE选项" href="http://gxkon.top/posts/7fd407bc/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5/js/md5.min.js"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"本人,超帅,打钱","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/Pic/avatar.png" onerror="onerror=null;src='/Pic/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">96</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">65</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">45</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 娱乐</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Windwos批处理bat教程及实用命令"><span class="toc-text">Windwos批处理bat教程及实用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、教程"><span class="toc-text">一、教程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-参考网络上的教程"><span class="toc-text">1.1 参考网络上的教程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-简单介绍"><span class="toc-text">1.2 简单介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-常用命令"><span class="toc-text">1.3 常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#echo-和-回显控制命令"><span class="toc-text">echo 和 @回显控制命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#条件判断：if-（区分大小写）"><span class="toc-text">条件判断：if （区分大小写）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#IF格式："><span class="toc-text">IF格式：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#常用的几种情形："><span class="toc-text">常用的几种情形：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#其他关系符号"><span class="toc-text">其他关系符号</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#注释的几种方式"><span class="toc-text">注释的几种方式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#和rem的区别"><span class="toc-text">::和rem的区别</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pause-暂停"><span class="toc-text">Pause 暂停</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#"><span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dir-显示目录中的文件和子目录列表"><span class="toc-text">Dir 显示目录中的文件和子目录列表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CD-更改当前目录"><span class="toc-text">CD 更改当前目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MD-创建目录"><span class="toc-text">MD 创建目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RD-删除目录"><span class="toc-text">RD 删除目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DEL-删除文件"><span class="toc-text">DEL 删除文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#REN-文件重命名"><span class="toc-text">REN 文件重命名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#COPY-拷贝文件"><span class="toc-text">COPY 拷贝文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#逻辑运算符"><span class="toc-text">逻辑运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#amp"><span class="toc-text">&amp;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#amp-amp"><span class="toc-text">&amp;&amp;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#-1"><span class="toc-text">||</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#管道命令"><span class="toc-text">|  管道命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gt-和-gt-gt-输出重定向命令"><span class="toc-text">&gt; 和 &gt;&gt;输出重定向命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-不常用命令"><span class="toc-text">1.4 不常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#more-外部命令-逐屏显示"><span class="toc-text">more (外部命令)逐屏显示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#find-外部命令-查找命令"><span class="toc-text">find (外部命令)查找命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#type显示文件内容"><span class="toc-text">type显示文件内容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#title设置cmd窗口的标题"><span class="toc-text">title设置cmd窗口的标题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ver显示系统版本"><span class="toc-text">ver显示系统版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#label-和-vol设置卷标"><span class="toc-text">label 和 vol设置卷标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#date-和-time-日期和时间"><span class="toc-text">date 和 time 日期和时间</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GOTO"><span class="toc-text">GOTO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#assoc-和-ftype文件关联"><span class="toc-text">assoc 和 ftype文件关联</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pushd-和-popd切换当前目录"><span class="toc-text">pushd 和 popd切换当前目录</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#subst-外部命令-映射磁盘。"><span class="toc-text">subst (外部命令)映射磁盘。</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#其他"><span class="toc-text">其他</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ping-n-2-127-0-0-1-gt-nul"><span class="toc-text">ping -n 2 127.0.0.1 &gt; nul</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-查看当前路径"><span class="toc-text">1.5 查看当前路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-xcopy命令"><span class="toc-text">1.6 xcopy命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-系统变量和动态变量"><span class="toc-text">1.7  系统变量和动态变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-8-设置变量SET"><span class="toc-text">1.8 设置变量SET</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-8-SC-外部命令-服务控制命令"><span class="toc-text">1.8 SC (外部命令)服务控制命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、实用命令"><span class="toc-text">二、实用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-0-IE设置"><span class="toc-text">2.0 IE设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-系统"><span class="toc-text">2.1 系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#cmd建立别名-短语"><span class="toc-text">cmd建立别名 - 短语</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取桌面路径"><span class="toc-text">获取桌面路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#生成URL快捷方式并且设置图标"><span class="toc-text">生成URL快捷方式并且设置图标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5秒后息屏"><span class="toc-text">5秒后息屏</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#设置开机启动项-禁止开启项"><span class="toc-text">设置开机启动项\禁止开启项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#复制当前目录的文件到其他文件夹"><span class="toc-text">复制当前目录的文件到其他文件夹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#复制当前目录下的文件夹到其他文件夹"><span class="toc-text">复制当前目录下的文件夹到其他文件夹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#设置环境变量"><span class="toc-text">设置环境变量</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#简单bat方法"><span class="toc-text">简单bat方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#注册表方法"><span class="toc-text">注册表方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-网络"><span class="toc-text">2.2 网络</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#获取本机MAC地址"><span class="toc-text">获取本机MAC地址</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#全部"><span class="toc-text">全部</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#搜索正在用的"><span class="toc-text">搜索正在用的</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#设置固定IP"><span class="toc-text">设置固定IP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#设置自动获取IP"><span class="toc-text">设置自动获取IP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WIFI密码查看"><span class="toc-text">WIFI密码查看</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看以往WIFI密码"><span class="toc-text">查看以往WIFI密码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-软件"><span class="toc-text">2.3 软件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#微信多开方法"><span class="toc-text">微信多开方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、问题"><span class="toc-text">三、问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Q1-导出时文件或者使用时，出现乱码"><span class="toc-text">Q1:导出时文件或者使用时，出现乱码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q2：命令没有错，但是就是找不到文件（中文文件）"><span class="toc-text">Q2：命令没有错，但是就是找不到文件（中文文件）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q3：访问遭到拒绝"><span class="toc-text">Q3：访问遭到拒绝</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#右键-管理员模式打开"><span class="toc-text">右键 - 管理员模式打开</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://tvax4.sinaimg.cn/large/4a9e9735gy1gdx2kud32xj20zk0qoaly.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Gxkon's Blog</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 娱乐</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Windwos批处理教程及实用命令</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-04-17 20:18:54"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-04-17</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-09-29 14:37:29"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-09-29</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E7%B3%BB%E7%BB%9F/">系统</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E7%B3%BB%E7%BB%9F/Windows/">Windows</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/posts/1684f4d3/#post-comment"><span class="gitalk-comment-count comment-count"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="Windwos批处理bat教程及实用命令"><a href="#Windwos批处理bat教程及实用命令" class="headerlink" title="Windwos批处理bat教程及实用命令"></a>Windwos批处理bat教程及实用命令</h1><h2 id="一、教程"><a href="#一、教程" class="headerlink" title="一、教程"></a>一、教程</h2><h3 id="1-1-参考网络上的教程"><a href="#1-1-参考网络上的教程" class="headerlink" title="1.1 参考网络上的教程"></a>1.1 参考网络上的教程</h3><p><a href="https://www.yiibai.com/batch_script/" target="_blank" rel="noopener">超详细批处理教程！</a><br><a href="https://www.cnblogs.com/Jian-Zhang/p/6066429.html" target="_blank" rel="noopener">批处理 for参数之token详解</a><br><a href="https://baike.baidu.com/item/%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6" target="_blank" rel="noopener">百度百科</a></p>
<p><a href="https://blog.csdn.net/Joker_N/article/details/89838719" target="_blank" rel="noopener">批处理菜鸟教程</a></p>
<p><a href="http://www.bathome.net/" target="_blank" rel="noopener">批处理之家</a></p>
<blockquote>
<p>想知道批处理某个命令的意思，就在CMD中输入【XX/?】即可</p>
<p>比如：“ for /? ”</p>
</blockquote>
<h3 id="1-2-简单介绍"><a href="#1-2-简单介绍" class="headerlink" title="1.2 简单介绍"></a>1.2 简单介绍</h3><blockquote>
<p>批处理就是一种脚本，可以简单也可以复杂的，自动化执行命令，提高效率</p>
</blockquote>
<ul>
<li><code>echo off</code> 命令确保执行代码时不显示命令<ul>
<li><code>echo [{on|off}] [message]</code></li>
</ul>
</li>
<li><code>pause</code> 暂停命令</li>
<li><code>cls</code> 清除屏幕。执行该命令后，屏幕上的所有信息都被清除，光标重新定位至屏幕左上角</li>
<li><code>Rem</code> rem语句后面的任何文本都被认为是注释，不会被执</li>
<li><code>&#39;&gt;&#39;</code>命令用于将输出重定向到文件C:\lists.txt</li>
<li><code>set</code> 显示、设置或删除变量，变量不区分类型</li>
<li><code>::</code> 双冒号,也是注释，后面的语句也不会执行</li>
<li><code>ren setTest.txt setTest.bat</code> 把文件1重名名为文件</li>
<li><code>echo %JAVA_HOME%</code> 使用echo %变量%，可以输出变量的值，例如输出JAVA_HOME环境变量的值</li>
<li><code>call</code>从一个批处理程序调用另一个批处理程序，并且不终止父批处理程序<ul>
<li>Syntax：call [路径文件名] [标签]</li>
</ul>
</li>
<li><code>start</code> 调用外部程序，所有的DOS命令和命令行程序都可以由start命令来调用</li>
<li><code>echo %errorlevel%</code>每个命令运行结束，可以用这个命令行格式查看返回码，<ul>
<li>用于判断刚才的命令是否执行成功，默认值为0，</li>
<li>一般命令执行出错会设 errorlevel 为1</li>
</ul>
</li>
</ul>
<h3 id="1-3-常用命令"><a href="#1-3-常用命令" class="headerlink" title="1.3 常用命令"></a>1.3 常用命令</h3><h4 id="echo-和-回显控制命令"><a href="#echo-和-回显控制命令" class="headerlink" title="echo 和 @回显控制命令"></a>echo 和 @回显控制命令</h4><p>关闭回显：是指运行批处理文件时，不显示文件里的每条命令，只显示运行结果批处理开始和结束时，系统都会自动打开回显</p>
<ul>
<li><code>@</code>             #关闭单行回显</li>
<li><code>echo off</code>        #从下一行开始关闭回显</li>
<li><code>@echo off</code>        #从本行开始关闭回显。一般批处理第一行都是这个</li>
<li><code>echo on</code>         #从下一行开始打开回显</li>
<li><code>echo</code>           #显示当前是 echo off 状态还是 echo on 状态</li>
<li><code>echo.</code>          #输出一个”回车换行”，一般就是指空白行</li>
<li><code>echo hello world</code>   #输出hello world</li>
</ul>
<h4 id="条件判断：if-（区分大小写）"><a href="#条件判断：if-（区分大小写）" class="headerlink" title="条件判断：if （区分大小写）"></a>条件判断：if （区分大小写）</h4><h5 id="IF格式："><a href="#IF格式：" class="headerlink" title="IF格式："></a>IF格式：</h5><ul>
<li><code>if 条件表达式 (语句1) else (语句2)</code><ul>
<li>如果条件表达式成立，那么，就执行语句1，否则，将执行语句2。</li>
</ul>
</li>
<li><code>if 条件表达式 语句</code><ul>
<li>如果条件表达式成立，将执行语句，否则，什么也不做</li>
</ul>
</li>
<li>可以嵌套</li>
</ul>
<h5 id="常用的几种情形："><a href="#常用的几种情形：" class="headerlink" title="常用的几种情形："></a>常用的几种情形：</h5><ul>
<li><code>if exist</code>：判断驱动器、文件或文件夹是否存在<ul>
<li>if exist d:\test.txt (echo D盘下有test.txt存在) else (echo D盘下不存在test.txt)</li>
</ul>
</li>
<li><code>if &quot;字符串1&quot;==&quot;字符串2&quot;</code> ：判断某两个字符串是否相等<ul>
<li>if “abc”==”xyz” (echo 字符串abc等于字符串xyz) else (echo 字符串abc不等于字符串xyz)</li>
</ul>
</li>
<li><code>if 数值1 equ 数值2</code> ：判断某两个数值是否相等<ul>
<li>if 1 equ 2 (echo 1等于2) else (echo 1不等于2)</li>
</ul>
</li>
<li><code>if defined str</code>：判断某个变量是否已经被赋值<ul>
<li>if defined str (echo 变量str已经被赋值，其值为%str%) else (echo 变量str的值为空)</li>
</ul>
</li>
</ul>
<h5 id="其他关系符号"><a href="#其他关系符号" class="headerlink" title="其他关系符号"></a>其他关系符号</h5><table>
<thead>
<tr>
<th align="center"><strong>中文含义</strong></th>
<th align="center"><strong>关系符</strong></th>
<th align="center"><strong>英文解释</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">等于</td>
<td align="center">equ</td>
<td align="center">equal</td>
</tr>
<tr>
<td align="center">大于</td>
<td align="center">gtr</td>
<td align="center">greater than</td>
</tr>
<tr>
<td align="center">大于或等于</td>
<td align="center">geq</td>
<td align="center">greater than or equal</td>
</tr>
<tr>
<td align="center">小于</td>
<td align="center">lss</td>
<td align="center">less than</td>
</tr>
<tr>
<td align="center">小于或不等于</td>
<td align="center">leq</td>
<td align="center">less than or equal</td>
</tr>
<tr>
<td align="center">不等于</td>
<td align="center">neq</td>
<td align="center">no equal</td>
</tr>
</tbody></table>
<h4 id="注释的几种方式"><a href="#注释的几种方式" class="headerlink" title="注释的几种方式"></a>注释的几种方式</h4><ul>
<li><code>:: 注释内容</code> 第一个冒号后也可以跟任何一个非字母数字的字符</li>
<li><code>rem 注释内容</code> 不能出现重定向符号和管道符号</li>
<li><code>echo 注释内容</code> 不能出现重定向符号和管道符号 〉nul</li>
<li><code>%注释内容%</code> 可以用作行间注释 不能出现重定向符号和管道符号</li>
<li><code>goto 标签 注释内容</code> 可以用作说明goto的条件和执行内容</li>
<li><code>:标签 注释内容</code> 可以用作标签下方段的执行内容</li>
<li><code>:注释内容</code> 注释文本不能与已有标签重名</li>
<li><code>if not exist nul 注释内容</code>（不能出现重定向符号和管道符号）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 多行注释，段注释</span></span><br><span class="line">    goto start</span><br><span class="line">     = 可以是多行文本，可以是命令</span><br><span class="line">     = 可以包含重定向符号和其他特殊字符</span><br><span class="line">     = 只要不包含 :start 这一行，就都是注释</span><br><span class="line">    :start</span><br></pre></td></tr></table></figure>

<h5 id="和rem的区别"><a href="#和rem的区别" class="headerlink" title="::和rem的区别"></a><strong>::</strong>和rem的区别</h5><ul>
<li>当关闭回显时，rem和<strong>::</strong>后的内容都不会显示</li>
<li>但是当打开回显时<ul>
<li>rem 后的内容<code>会显示</code></li>
<li><strong>::</strong>后的内容<code>不会显示</code></li>
</ul>
</li>
</ul>
<h4 id="Pause-暂停"><a href="#Pause-暂停" class="headerlink" title="Pause 暂停"></a>Pause 暂停</h4><p><strong>运行该命令时，将显示下面的消息：请按任意键继续 . . .</strong></p>
<ul>
<li>不仅仅是用来看输出结果</li>
<li>还可以暂定后，等待，再按键</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//驱动器 G 中磁盘上的所有文件均复制到d:\back中</span><br><span class="line">//提示您将另一张光盘盘放入驱动器 G 时，pause 命令会使程序挂起，</span><br><span class="line">//以便您更换光盘，然后按任意键继续处理</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:begin</span><br><span class="line">copy G:*.* d:\back</span><br><span class="line"><span class="built_in">echo</span> 请插入另一张光盘...</span><br><span class="line">pause</span><br><span class="line">goto begin</span><br></pre></td></tr></table></figure>

<h5 id=""><a href="#" class="headerlink" title=""></a></h5><h4 id="Dir-显示目录中的文件和子目录列表"><a href="#Dir-显示目录中的文件和子目录列表" class="headerlink" title="Dir 显示目录中的文件和子目录列表"></a>Dir 显示目录中的文件和子目录列表</h4><ul>
<li><code>...</code> 代表当前目录</li>
<li><code>..</code> 代表当前目录的上级目录</li>
<li><code>dir</code>           #显示当前目录中的文件和子目录</li>
<li><code>dir .</code>          #显示当前目录中的文件和子目录</li>
<li><code>dir ..</code>         #显示当前目录的上级目录中的文件和子目录</li>
<li><code>dir /a</code>         #显示当前目录中的文件和子目录，包括隐藏文件和系统文件</li>
<li><code>dir c: /a:d</code>      #显示 C 盘当前目录中的目录</li>
<li><code>dir c:\ /a:-d</code>    #显示 C 盘根目录中的文件</li>
<li><code>dir d:\mp3 /b/p</code>   #逐屏显示 d:\mp3 目录里的文件，只显示文件名，不显示时间和大小</li>
<li><code>dir *.exe /s</code>显示当前目录和子目录里所有的.exe文件<ul>
<li>其中 * 是通配符，代表所有的文件名<ul>
<li>如 c<em>.</em> 代表以 c 开头的所有文件</li>
</ul>
</li>
<li>还一个通配符 ? 代表一个任意字母或汉字<ul>
<li>?.exe 代表所有文件名是一个字母的.exe文件</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>如果指定的目录或文件不存在，将返回 errorlevel 为1</p>
</blockquote>
<h4 id="CD-更改当前目录"><a href="#CD-更改当前目录" class="headerlink" title="CD 更改当前目录"></a>CD 更改当前目录</h4><ul>
<li><code>cd mp3</code>         #进入当前目录中的mp3 目录</li>
<li><code>cd ..</code>          #进入当前目录中的上级目录</li>
<li><code>cd\</code>           #进入根目录</li>
<li><code>cd</code>            #显示当前目录</li>
<li><code>cd /d d:\mp3</code>     #可以同时更改盘符和目录</li>
</ul>
<h4 id="MD-创建目录"><a href="#MD-创建目录" class="headerlink" title="MD 创建目录"></a>MD 创建目录</h4><p><code>md abc</code>         #在当前目录里建立子目录 abc<br><code>md d:\a\b\c</code>      #如果 d:\a 不存在，将会自动创建</p>
<h4 id="RD-删除目录"><a href="#RD-删除目录" class="headerlink" title="RD 删除目录"></a>RD 删除目录</h4><p><code>rd abc</code>         #删除当前目录里的 abc 子目录，要求为空目录<br><code>rd /s/q d:\temp</code>   #删除 d:\temp 文件夹及其子文件夹和文件，不需要按 Y 确认</p>
<h4 id="DEL-删除文件"><a href="#DEL-删除文件" class="headerlink" title="DEL 删除文件"></a>DEL 删除文件</h4><p><code>del d:\test.txt</code>                           #删除指定文件，不能是隐藏、系统、只读文件<br><code>del *.*</code>                                                 #删除当前目录里的所有文件，不包括隐藏、系统、只读文件，要求按 Y 确认<br><code>del /q/a/f d:\temp\*.*</code>        #删除 d:\temp 文件夹里面的所有文件，包括隐藏、只读、系统文件，不包括子目录<br><code>del /q/a/f/s d:\temp\*.*</code>    #删除 d:\temp 及子文件夹里面的所有文件，包括隐藏、只读、系统文件，不包括子目录</p>
<h4 id="REN-文件重命名"><a href="#REN-文件重命名" class="headerlink" title="REN 文件重命名"></a>REN 文件重命名</h4><p><code>ren 1.txt 2.bak</code>   #把 1.txt 更名为 2.bak<br><code>ren *.txt *.ini</code>   #把当前目录里所有.txt文件改成.ini文件<br><code>ren d:\temp tmp</code>   #支持对文件夹的重命名</p>
<h4 id="COPY-拷贝文件"><a href="#COPY-拷贝文件" class="headerlink" title="COPY 拷贝文件"></a>COPY 拷贝文件</h4><ul>
<li><code>copy c:\test.txt d:\</code>复制 c:\test.txt 文件到 d:\</li>
<li><code>copy c:\test.txt d:\test.bak</code>复制 c:\test.txt 文件到 d:\ ，并重命名为 test.bak</li>
<li><code>copy c:\*.*</code>复制 c:\ 所有文件到当前目录，不包括隐藏文件和系统文件不指定目标路径，则默认目标路径为当前目录</li>
<li><code>copy con test.txt</code>从屏幕上等待输入，<ul>
<li>按 Ctrl+Z 结束输入，</li>
<li>输入内容存为test.txt文件</li>
<li><code>con代表屏幕，prn代表打印机，nul代表空设备</code></li>
</ul>
</li>
</ul>
<h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><h5 id="amp"><a href="#amp" class="headerlink" title="&amp;"></a>&amp;</h5><p>顺序执行多条命令，而<code>不管命令是否执行成功</code></p>
<ul>
<li><code>c: &amp; cd\ &amp; dir /w</code>相当于把下面3行命令写到1行去了c:cd\dir /w</li>
</ul>
<h5 id="amp-amp"><a href="#amp-amp" class="headerlink" title="&amp;&amp;"></a>&amp;&amp;</h5><p>顺序执行多条命令，当碰到执行<code>出错</code>的命令后将<code>不执行</code>后面的命令</p>
<ul>
<li><code>f: &amp;&amp; cd\ &amp;&amp; dir &gt;c:\test.txt</code>注意如果f盘不存在，那么后面2条命令将不会执行</li>
<li><code>find &quot;ok&quot; c:\test.txt &amp;&amp; echo</code> 成功如果找到了”ok”字样，就显示”成功”，找不到就不显示</li>
</ul>
<h5 id="-1"><a href="#-1" class="headerlink" title="||"></a>||</h5><p>顺序执行多条命令，当碰到执行<code>正确</code>的命令后将<code>不执行</code>后面的命令</p>
<ul>
<li><code>find &quot;ok&quot; c:\test.txt || echo</code> 不成功如果找不到”ok”字样，就显示”不成功”，找到了就不显示</li>
</ul>
<h4 id="管道命令"><a href="#管道命令" class="headerlink" title="|  管道命令"></a>|  管道命令</h4><p>前一个命令的执行结果输出到后一个命令</p>
<ul>
<li><code>dir *.* /s/a | find /c &quot;.exe&quot;</code>  先执行 dir 命令，对其输出的结果，执行后面的 find 命令该命令行结果：<ul>
<li>输出当前文件夹及所有子文件夹里的.exe文件的个数</li>
</ul>
</li>
<li><code>type c:\test.txt|more</code>这个和 more c:\test.txt 的效果是一样的</li>
</ul>
<h4 id="gt-和-gt-gt-输出重定向命令"><a href="#gt-和-gt-gt-输出重定向命令" class="headerlink" title="&gt; 和 &gt;&gt;输出重定向命令"></a>&gt; 和 &gt;&gt;输出重定向命令</h4><ul>
<li><code>&gt;</code> 清除文件中原有的内容后再写入</li>
<li><code>&gt;&gt;</code> 追加内容到文件末尾，而不会清除原有的内容，<ul>
<li>主要将本来显示在屏幕上的内容，输出到指定文件中，</li>
<li>指定文件如果不存在，则自动生成该文件</li>
</ul>
</li>
</ul>
<ul>
<li><p><code>echo hello world&gt;c:\test.txt</code>生成c:\test.txt文件，内容为hello world，</p>
<ul>
<li>这个格式在批处理文件里用得很多，</li>
<li>可以生成.reg .bat .vbs 等临时文件</li>
</ul>
</li>
<li><p><code>type c:\test.txt &gt;prn</code>屏幕上不显示文件内容，转向输出到打印机</p>
</li>
<li><p><code>echo hello world&gt;con</code>在屏幕上显示hello world，实际上所有输出都是默认 &gt;con 的</p>
</li>
<li><p><code>copy c:\test.txt f: &gt;nul</code> 拷贝文件，并且不显示”文件复制成功”的提示信息，但如果f盘不存在，还是会显示出错信息</p>
</li>
<li><p><code>copy c:\test.txt f: &gt;nul 2&gt;nul</code>不显示”文件复制成功”的提示信息，并且f盘不存在的话，也不显示错误提示信息</p>
</li>
<li><p><code>echo ^^W ^&gt; ^W&gt;c:\test.txt</code>生成的文件内容为 ^W &gt; W^ 和 &gt; 是控制命令，</p>
<ul>
<li>要把它们输出到文件，必须在前面加个 ^符号</li>
</ul>
</li>
</ul>
<h3 id="1-4-不常用命令"><a href="#1-4-不常用命令" class="headerlink" title="1.4 不常用命令"></a>1.4 不常用命令</h3><h4 id="more-外部命令-逐屏显示"><a href="#more-外部命令-逐屏显示" class="headerlink" title="more (外部命令)逐屏显示"></a>more (外部命令)逐屏显示</h4><p>more c:\test.txt  #逐屏显示 c:\test.txt 的文件内容</p>
<h4 id="find-外部命令-查找命令"><a href="#find-外部命令-查找命令" class="headerlink" title="find (外部命令)查找命令"></a>find (外部命令)查找命令</h4><p><code>find &quot;abc&quot; c:\test.txt</code>在 c:\test.txt 文件里查找含 abc 字符串的行如果找不到，将设 errorlevel 返回码为1<br><code>find /i &quot;abc&quot; c:\test.txt</code>查找含 abc 的行，忽略大小写<br><code>find /c &quot;abc&quot; c:\test.txt</code>显示含 abc 的行的行数</p>
<h4 id="type显示文件内容"><a href="#type显示文件内容" class="headerlink" title="type显示文件内容"></a>type显示文件内容</h4><p><code>type c:\boot.ini</code>  #显示指定文件的内容，程序文件一般会显示乱码<br><code>type *.txt</code>      #显示当前目录里所有.txt文件的内容</p>
<h4 id="title设置cmd窗口的标题"><a href="#title设置cmd窗口的标题" class="headerlink" title="title设置cmd窗口的标题"></a>title设置cmd窗口的标题</h4><p><code>title 新标题</code>     #可以看到cmd窗口的标题栏变了</p>
<h4 id="ver显示系统版本"><a href="#ver显示系统版本" class="headerlink" title="ver显示系统版本"></a>ver显示系统版本</h4><h4 id="label-和-vol设置卷标"><a href="#label-和-vol设置卷标" class="headerlink" title="label 和 vol设置卷标"></a>label 和 vol设置卷标</h4><p><code>vol</code>           #显示卷标<br><code>label</code>          #显示卷标，同时提示输入新卷标<br><code>label c:system</code>    #设置C盘的卷标为 system</p>
<h4 id="date-和-time-日期和时间"><a href="#date-和-time-日期和时间" class="headerlink" title="date 和 time 日期和时间"></a>date 和 time 日期和时间</h4><p><code>date</code>      #显示当前日期，并提示输入新日期，按”回车”略过输入<br><code>date /t</code>     #只显示当前日期，不提示输入新日期<br><code>time</code>      #显示当前时间，并提示输入新时间，按”回车”略过输入<br><code>time /t</code>     #只显示当前时间，不提示输入新时间</p>
<h4 id="GOTO"><a href="#GOTO" class="headerlink" title="GOTO"></a>GOTO</h4><p>goto是个跳转命令，紧跟其之后的是标签名；<br>冒号是一个标签标志，紧跟其之后的是标签名，两者合称标签<br>当程序运行到goto时，将自动跳转到冒号定义的部分去执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> /p input=请输入字母A或B: </span><br><span class="line"><span class="keyword">if</span> <span class="string">"%input%"</span>==<span class="string">"A"</span> goto A</span><br><span class="line"><span class="keyword">if</span> <span class="string">"%input%"</span>==<span class="string">"B"</span> goto B</span><br><span class="line">pause </span><br><span class="line"><span class="built_in">exit</span> </span><br><span class="line"></span><br><span class="line">:A</span><br><span class="line"><span class="built_in">echo</span> 您输入的字母是A</span><br><span class="line">pause</span><br><span class="line"></span><br><span class="line">:B</span><br><span class="line"><span class="built_in">echo</span> 您输入的字母是B</span><br><span class="line">pause</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<p>使用goto语句注意事项：</p>
<p>  　　1. 一一对应。goto语句与标签要相互对应。不允许只有goto语句而没有相应的标签段，否则，程序将找不到相应的标签段而直接退出；只有标签段而没有goto语句是允许的，但不能实现流程跳转功能，从代码精简的角度来看，有标签段而没有goto语句，则此标签是多余的，大可精剪。<br>        　　2. 多个标签。若有多个标签段，则需要注意标签段之间是否需要添加恰当的退出语句来终止程序继续向下执行，这是很多新手很容易犯错的地方，需要谨慎。<br>              　　3. 标签名只可以使用常量，而不能使用变量；</p>
<h4 id="assoc-和-ftype文件关联"><a href="#assoc-和-ftype文件关联" class="headerlink" title="assoc 和 ftype文件关联"></a>assoc 和 ftype文件关联</h4><ul>
<li><p><code>assoc</code> 设置’文件扩展名’关联，关联到’文件类型’</p>
</li>
<li><p><code>ftype</code> 设置’文件类型’关联，关联到’执行程序和参数’</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">assoc           <span class="comment">#显示所有'文件扩展名'关联</span></span><br><span class="line">assoc .txt      <span class="comment">#显示.txt代表的'文件类型'，结果显示 .txt=txtfile</span></span><br><span class="line">assoc .doc      <span class="comment">#显示.doc代表的'文件类型'，结果显示 .doc=Word.Document.8</span></span><br><span class="line">assoc .exe      <span class="comment">#显示.exe代表的'文件类型'，结果显示 .exe=exefile</span></span><br><span class="line">ftype           <span class="comment">#显示所有'文件类型'关联</span></span><br><span class="line">ftype exefile   <span class="comment">#显示exefile类型关联的命令行，结果显示 exefile="%1" %* </span></span><br><span class="line">assoc .txt=Word.Document.8 <span class="comment">#设置.txt为word类型的文档，可以看到.txt文件的图标都变了</span></span><br><span class="line">assoc .txt=txtfile <span class="comment">#恢复.txt的正确关联 ftype exefile="%1" %*恢复 exefile 的正确关联如果该关联已经被破坏，可以运行 command.com ，再输入这条命令</span></span><br></pre></td></tr></table></figure>

<h4 id="pushd-和-popd切换当前目录"><a href="#pushd-和-popd切换当前目录" class="headerlink" title="pushd 和 popd切换当前目录"></a>pushd 和 popd切换当前目录</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">c: &amp; <span class="built_in">cd</span>\ &amp; md mp3       <span class="comment">#在 C:\ 建立 mp3 文件夹</span></span><br><span class="line">md d:\mp4               <span class="comment">#在 D:\ 建立 mp4 文件夹</span></span><br><span class="line"><span class="built_in">cd</span> /d d:\mp4            <span class="comment">#更改当前目录为 d:\mp4</span></span><br><span class="line"><span class="built_in">pushd</span> c:\mp3            <span class="comment">#保存当前目录，并切换当前目录为 c:\mp3</span></span><br><span class="line"><span class="built_in">popd</span>                    <span class="comment">#恢复当前目录为刚才保存的 d:\mp4一般用处不大，在当前目录名不确定时，会有点帮助</span></span><br></pre></td></tr></table></figure>

<h3 id="subst-外部命令-映射磁盘。"><a href="#subst-外部命令-映射磁盘。" class="headerlink" title="subst (外部命令)映射磁盘。"></a>subst (外部命令)映射磁盘。</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">subst z: \\server\d   <span class="comment">#这样输入z:就可以访问\\server\d了</span></span><br><span class="line">subst z: /d        <span class="comment">#取消该映射</span></span><br><span class="line">subst            <span class="comment">#显示目前所有的映</span></span><br></pre></td></tr></table></figure>

<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><p><code>\&gt;&amp;</code> 将一个句柄的输出写入到另一个句柄的输入中<br><code>&lt;&amp;</code> 从一个句柄读取输入并将其写入到另一个句柄输出中shift 命令行传递给批处理的参数不止9个时，用以切换参数color 设置cmd窗口的显示颜色<br><code>pormpt</code> 更改命令提示符号，默认都是 盘符:\路径&gt; ，如 c:&gt;</p>
<h4 id="ping-n-2-127-0-0-1-gt-nul"><a href="#ping-n-2-127-0-0-1-gt-nul" class="headerlink" title="ping -n 2 127.0.0.1 &gt; nul"></a><code>ping -n 2 127.0.0.1 &gt; nul</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ping -n 2 127.0.0.1 &gt; nul</span><br><span class="line"><span class="comment">#0 简单的说ping -n 10 127.1&gt;nul 就是让程序等待N秒</span></span><br><span class="line"><span class="comment">#1 127.0.0.1是一个本机ip,不管是否答有连网,只要电脑上有网卡这个ip就存在,常有人用这个ping命令来测试网卡是否完好</span></span><br><span class="line">    <span class="comment">#ping 127.0.0.1就是ping 还回地址，没有实问际意义，如果ping 127.0.0.1正常说明本机的IP协议栈没问答题</span></span><br><span class="line"><span class="comment">#2 -n 2指的是发送两个数据包，用内来控制时间。&gt;nul是重定向容输出</span></span><br><span class="line"><span class="comment">#3 127.0.0.1也可以简写成127.1，</span></span><br><span class="line"><span class="comment">#4 ping 127.1 -n n就是ping的次数，ping -n 10 127.1&gt;nul 加 nul 的意思就是 不显示结果</span></span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="1-5-查看当前路径"><a href="#1-5-查看当前路径" class="headerlink" title="1.5 查看当前路径"></a>1.5 查看当前路径</h3><ul>
<li>当前盘符：<code>%~d0</code>    —– &gt; <code>E:</code></li>
<li>当前盘符和路径：<code>%~dp0</code>  —– &gt;  <code>E:\桌面\</code></li>
<li>当前批处理全路径：<code>%~f0</code>  —– &gt;  <code>E:\桌面\222.bat</code></li>
<li>当前盘符和路径的短文件名格式：<code>%~sdp0</code>  —– &gt;  <code>E:\桌面\</code></li>
<li>当前CMD默认目录：<code>%cd%</code>  —– &gt;   <code>E:\桌面</code><ul>
<li>如果右键-bat文件，以管理员模式打开bat文件的话，当前的CMD目录则  <code>C:\Windows\system32</code></li>
<li>涉及到权限的命令和文件路径的命令时，不建议用这个，否则会出现，找不到文件的情况</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//目录中有空格也可以加入<span class="string">""</span>避免找不到路径</span><br><span class="line"><span class="built_in">echo</span> 当前盘符：<span class="string">"%~d0"</span></span><br><span class="line"><span class="built_in">echo</span> 当前盘符和路径：<span class="string">"%~dp0"</span></span><br><span class="line"><span class="built_in">echo</span> 当前批处理全路径：<span class="string">"%~f0"</span></span><br><span class="line"><span class="built_in">echo</span> 当前盘符和路径的短文件名格式：<span class="string">"%~sdp0"</span></span><br><span class="line"><span class="built_in">echo</span> 当前CMD默认目录：<span class="string">"%cd%"</span></span><br></pre></td></tr></table></figure>

<h3 id="1-6-xcopy命令"><a href="#1-6-xcopy命令" class="headerlink" title="1.6 xcopy命令"></a>1.6 xcopy命令</h3><p>查看帮助文档，<code>xcopy /?</code></p>
<p>参考：<a href="https://blog.csdn.net/qq_21808961/article/details/86749733" target="_blank" rel="noopener">实例教程</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\lan&gt;xcopy /?</span><br><span class="line">复制文件和目录树。</span><br><span class="line">XCOPY <span class="built_in">source</span> [destination] [/A | /M] [/D[:date]] [/P] [/S [/E]] [/V] [/W]</span><br><span class="line">                           [/C] [/I] [/Q] [/F] [/L] [/G] [/H] [/R] [/T] [/U]</span><br><span class="line">                           [/K] [/N] [/O] [/X] [/Y] [/-Y] [/Z] [/B] [/J]</span><br><span class="line">                           [/EXCLUDE:file1[+file2][+file3]...]</span><br><span class="line">  <span class="built_in">source</span>       指定要复制的文件。</span><br><span class="line">  destination  指定新文件的位置和/或名称。</span><br><span class="line">  /A           仅复制有存档属性集的文件，</span><br><span class="line">               但不更改属性。</span><br><span class="line">  /M           仅复制有存档属性集的文件，</span><br><span class="line">               并关闭存档属性。</span><br><span class="line">  /D:m<span class="_">-d</span>-y     复制在指定日期或指定日期以后更改的文件。</span><br><span class="line">               如果没有提供日期，只复制那些</span><br><span class="line">               源时间比目标时间新的文件。</span><br><span class="line">  /EXCLUDE:file1[+file2][+file3]...</span><br><span class="line">               指定含有字符串的文件列表。每个字符串</span><br><span class="line">               在文件中应位于单独的一行。如果任何</span><br><span class="line">               字符串与复制文件的绝对路径的任何部分相符，</span><br><span class="line">               则排除复制该文件。例如，</span><br><span class="line">               指定如 \obj\ 或 .obj 的字符串会分别</span><br><span class="line">               排除目录 obj 下面的所有文件或带有</span><br><span class="line">               .obj 扩展名的所有文件。</span><br><span class="line">  /P           创建每个目标文件之前提示你。</span><br><span class="line">  /S           复制目录和子目录，不包括空目录。</span><br><span class="line">  /E           复制目录和子目录，包括空目录。</span><br><span class="line">               与 /S /E 相同。可以用来修改 /T。</span><br><span class="line">  /V           验证每个新文件的大小。</span><br><span class="line">  /W           提示你在复制前按键。</span><br><span class="line">  /C           即使有错误，也继续复制。</span><br><span class="line">  /I           如果目标不存在，且要复制多个文件，</span><br><span class="line">               则假定目标必须是目录。</span><br><span class="line">  /Q           复制时不显示文件名。</span><br><span class="line">  /F           复制时显示完整的源文件名和目标文件名。</span><br><span class="line">  /L           显示要复制的文件。</span><br><span class="line">  /G           允许将加密文件复制到</span><br><span class="line">               不支持加密的目标。</span><br><span class="line">  /H           也复制隐藏文件和系统文件。</span><br><span class="line">  /R           覆盖只读文件。</span><br><span class="line">  /T           创建目录结构，但不复制文件。不</span><br><span class="line">               包括空目录或子目录。/T /E 包括</span><br><span class="line">               空目录和子目录。</span><br><span class="line">  /U           只复制已经存在于目标中的文件。</span><br><span class="line">  /K           复制属性。一般的 Xcopy 会重置只读属性。</span><br><span class="line">  /N           用生成的短名称复制。</span><br><span class="line">  /O           复制文件所有权和 ACL 信息。</span><br><span class="line">  /X           复制文件审核设置(隐含 /O)。</span><br><span class="line">  /Y           取消提示以确认要覆盖</span><br><span class="line">               现有目标文件。</span><br><span class="line">  /-Y          要提示以确认要覆盖</span><br><span class="line">               现有目标文件。</span><br><span class="line">  /Z           在可重新启动模式下复制网络文件。</span><br><span class="line">  /B           复制符号链接本身与链接目标。</span><br><span class="line">  /J           复制时不使用缓冲的 I/O。推荐复制大文件时使用。</span><br><span class="line">开关 /Y 可以预先在 COPYCMD 环境变量中设置。</span><br><span class="line">这可能被命令行上的 /-Y 覆盖。</span><br></pre></td></tr></table></figure>

<h3 id="1-7-系统变量和动态变量"><a href="#1-7-系统变量和动态变量" class="headerlink" title="1.7  系统变量和动态变量"></a>1.7  系统变量和动态变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> %SystemDrive%     <span class="comment">#显示系统盘盘符</span></span><br><span class="line">%CD%                  <span class="comment">#代表当前目录的字符串</span></span><br><span class="line">%DATE%                <span class="comment">#当前日期</span></span><br><span class="line">%TIME%                <span class="comment">#当前时间</span></span><br><span class="line">%RANDOM%              <span class="comment">#随机整数，介于0~32767</span></span><br><span class="line">%ERRORLEVEL%          <span class="comment">#当前ERRORLEVEL 值</span></span><br><span class="line">%CMDEXTVERSION%       <span class="comment">#当前命令处理器扩展名版本号</span></span><br><span class="line">%CMDCMDLINE%          <span class="comment">#调用命令处理器的原始命令行可以用echo命令查看每个变量值，如 echo %time%注意 %time%精确到毫秒，在批处理需要延时处理时可以用到</span></span><br></pre></td></tr></table></figure>

<h3 id="1-8-设置变量SET"><a href="#1-8-设置变量SET" class="headerlink" title="1.8 设置变量SET"></a>1.8 设置变量SET</h3><p><code>set</code> 显示、设置或删除变量，变量不区分类型</p>
<ul>
<li>显示变量：<ul>
<li><code>set</code> 显示批处理当前已定义的所有变量及其值</li>
<li><code>set s</code>显示所有以s开头的变量及值</li>
</ul>
</li>
<li>设置变量<ul>
<li><code>set /A number=value</code> 设置数值型变量</li>
<li><code>set name=value</code> 设置非数值型变量</li>
</ul>
</li>
<li>引用变量：<strong>变量名两边加上个百分号</strong><ul>
<li>即 %变量名%</li>
</ul>
</li>
<li>删除变量：set 变量名=<ul>
<li><strong>set aa=</strong>  此句命令即可删除变量aa</li>
</ul>
</li>
<li>查看更多  <code>set  /?</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>                    <span class="comment">#显示目前所有可用的变量，包括系统变量和自定义的变量</span></span><br><span class="line"><span class="built_in">echo</span> %SystemDrive%     <span class="comment">#显示系统盘盘符。系统变量可以直接引用</span></span><br><span class="line"><span class="built_in">set</span> p                  <span class="comment">#显示所有以p开头的变量，要是一个也没有就设errorlevel=1</span></span><br><span class="line"><span class="built_in">set</span> p=aa1bb1aa2bb2     <span class="comment">#设置变量p，并赋值为 = 后面的字符串，即aa1bb1aa2bb2</span></span><br><span class="line"><span class="built_in">echo</span> %p%               <span class="comment">#显示变量p代表的字符串，即aa1bb1aa2bb2</span></span><br><span class="line"><span class="built_in">echo</span> %p:~6%            <span class="comment">#显示变量p中第6个字符以后的所有字符，即aa2bb2</span></span><br><span class="line"><span class="built_in">echo</span> %p:~6,3%          <span class="comment">#显示第6个字符以后的3个字符，即aa2</span></span><br><span class="line"><span class="built_in">echo</span> %p:~0,3%          <span class="comment">#显示前3个字符，即aa1</span></span><br><span class="line"><span class="built_in">echo</span> %p:~-2%           <span class="comment">#显示最后面的2个字符，即b2</span></span><br><span class="line"><span class="built_in">echo</span> %p:~0,-2%         <span class="comment">#显示除了最后2个字符以外的其它字符，即aa1bb1aa2b</span></span><br><span class="line"><span class="built_in">echo</span> %p:aa=c%          <span class="comment">#用c替换变量p中所有的aa，即显示c1bb1c2bb2</span></span><br><span class="line"><span class="built_in">echo</span> %p:aa=%           <span class="comment">#将变量p中的所有aa字符串置换为空，即显示1bb12bb2</span></span><br><span class="line"><span class="built_in">echo</span> %p:*bb=c%         <span class="comment">#第一个bb及其之前的所有字符被替换为c，即显示c1aa2bb2</span></span><br><span class="line"><span class="built_in">set</span> p=%p:*bb=c%        <span class="comment">#设置变量p，赋值为 %p:*bb=c% ，即c1aa2bb2</span></span><br><span class="line"><span class="built_in">set</span> /a p=39            <span class="comment">#设置p为数值型变量，值为39</span></span><br><span class="line"><span class="built_in">set</span> /a p=39/10         <span class="comment">#支持运算符，有小数时用去尾法，39/10=3.9，去尾得3，p=3</span></span><br><span class="line"><span class="built_in">set</span> /a p=p/10          <span class="comment">#用 /a参数时，在 = 后面的变量可以不加%直接引用</span></span><br><span class="line"><span class="built_in">set</span> /a p=<span class="string">"1&amp;0"</span>         <span class="comment">#"与"运算，要加引号</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> p=                 <span class="comment">#取消p变量</span></span><br><span class="line"><span class="built_in">set</span> /p p=请输入         <span class="comment">#屏幕上显示"请输入"，并会将输入的字符串赋值给变量p注意这条可以用来取代 choice 命令.</span></span><br><span class="line"></span><br><span class="line">注意变量在 <span class="keyword">if</span> 和 <span class="keyword">for</span> 的复合语句里是一次性全部替换的，如</span><br></pre></td></tr></table></figure>



<h3 id="1-8-SC-外部命令-服务控制命令"><a href="#1-8-SC-外部命令-服务控制命令" class="headerlink" title="1.8 SC (外部命令)服务控制命令"></a>1.8 SC (外部命令)服务控制命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sc create aaa displayname= bbb start= auto binpath= <span class="string">"C:\WINDOWS\System32\alg.exe"</span> <span class="comment">#创建服务，服务名称aaa，显示名称bbb，启动类型:自动可执行文件的路径"C:\WINDOWS\System32\alg.exe"</span></span><br><span class="line">sc description aaa <span class="string">"ccc"</span> <span class="comment">#更改aaa的描述为ccc</span></span><br><span class="line">sc config aaa start= disabled binpath= <span class="string">"C:\WINDOWS\System32\svchost.exe -k netsvcs"</span> <span class="comment">#更改aaa的启动类型:已禁用更改aaa的可执行文件的路径"C:\WINDOWS\System32\svchost.exe -k netsvcs"</span></span><br><span class="line">sc config aaa start= demand displayname= ddd <span class="comment">#更改aaa的启动类型:手动更改aaa的显示名称ddd</span></span><br><span class="line">sc start aaa启动aaa服务</span><br><span class="line">sc stop aaa停止aaa服务</span><br><span class="line">sc delete aaa删除aaa服务</span><br></pre></td></tr></table></figure>





<h2 id="二、实用命令"><a href="#二、实用命令" class="headerlink" title="二、实用命令"></a>二、实用命令</h2><blockquote>
<p>技巧：可以把bat文件放在 <code>右键-发送到</code> 的文件夹中</p>
<p>地址：Windows10的Sendto位置  %AppData%\Microsoft\Windows\SendTo</p>
</blockquote>
<h3 id="2-0-IE设置"><a href="#2-0-IE设置" class="headerlink" title="2.0 IE设置"></a>2.0 IE设置</h3><p>看本站文章<code>注册表和BAT批处理修改IE</code> 或者<a href="注册表和BAT批处理修改IE.md">这里</a></p>
<h3 id="2-1-系统"><a href="#2-1-系统" class="headerlink" title="2.1 系统"></a>2.1 系统</h3><h4 id="cmd建立别名-短语"><a href="#cmd建立别名-短语" class="headerlink" title="cmd建立别名 - 短语"></a><strong>cmd建立别名</strong> - 短语</h4><p>1.新建bat文件 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">在某个目录下，最好是英文路径（建议在C盘根目录）新建文件cmd_auto.bat , 输入自己需要的常用命令的别名。</span><br><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">doskey py=python $*</span><br><span class="line">doskey pi=pip install $*</span><br><span class="line">DOSKEY ag=C:\MinGW\msys\1.0\bin\ag.exe --nogroup $*    <span class="comment">#带有路径的</span></span><br><span class="line">@doskey ls=dir /b $*</span><br><span class="line">@doskey l=dir /od/p/q/tw $*</span><br><span class="line"></span><br><span class="line">说明：</span><br><span class="line">doskey相当于Linux中的<span class="built_in">alias</span>，等号左边是右边的别名；</span><br><span class="line">$*表示这个命令还可能有其他参数；</span><br><span class="line">@表示执行这条命令时不显示这条命令本身</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2、打开cmd，输入cmd /?，一直回车，可以看到CMD的注册表项</span><br><span class="line">一般只会是这两个</span><br><span class="line">HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor\AutoRun <span class="comment">#包含针对该计算机（对于任何用户）的配置信息</span></span><br><span class="line">  and/or</span><br><span class="line">HKEY_CURRENT_USER\Software\Microsoft\Command Processor\AutoRun <span class="comment">#包含当前登录用户的配置信息的根目录</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3、命令加入注册表 regedit  </span><br><span class="line">到HKEY_CURRENT_USER\Software\Microsoft\Command Processor 下</span><br><span class="line">如果没有AutoRun，则  右键--新建---字符串值--输入AutoRun</span><br><span class="line">选中AutoRun---右键--修改---</span><br><span class="line">把刚刚的Bat文件路径放入，保存，重启CMD即可</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考：<a href="https://www.cnblogs.com/fstang/archive/2013/04/06/3002006.html" target="_blank" rel="noopener">在cmd中为命令设置别名以及启动cmd时自动执行bat</a></p>
<p><a href="https://superuser.com/questions/49170/create-an-alias-in-windows-xp" target="_blank" rel="noopener">Create an alias in Windows XP</a></p>
<p><a href="https://blog.csdn.net/yiranzhiliposui/article/details/83116819" target="_blank" rel="noopener">window中的cmd中设置别名(alias)及设置快捷键打开cmd</a></p>
</blockquote>
<h4 id="获取桌面路径"><a href="#获取桌面路径" class="headerlink" title="获取桌面路径"></a>获取桌面路径</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /f <span class="string">"tokens=2,*"</span> %%i <span class="keyword">in</span> (<span class="string">'reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" /v "Desktop"'</span>) <span class="keyword">do</span> (</span><br><span class="line"><span class="built_in">set</span> desk=%%j</span><br><span class="line">)</span><br><span class="line"><span class="built_in">echo</span> 桌面路径是%desk%</span><br></pre></td></tr></table></figure>

<h4 id="生成URL快捷方式并且设置图标"><a href="#生成URL快捷方式并且设置图标" class="headerlink" title="生成URL快捷方式并且设置图标"></a>生成URL快捷方式并且设置图标</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@ECHO OFF</span><br><span class="line"><span class="built_in">set</span> u=<span class="string">"http://192.168.1.226:8001/fcxt_tyhjgxtg"</span></span><br><span class="line"><span class="built_in">set</span> n=<span class="string">"房管系统.url"</span></span><br><span class="line"><span class="keyword">for</span> /f <span class="string">"tokens=3"</span> %%i <span class="keyword">in</span> (<span class="string">'reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" /v "Desktop"'</span>) <span class="keyword">do</span> (</span><br><span class="line">ECHO [InternetShortcut]&gt;%%i\%n%</span><br><span class="line">ECHO URL=%u%&gt;&gt;%%i\%n%</span><br><span class="line">ECHO IconFile=C:\windows\system32\shell32.dll&gt;&gt;%%i\%n%</span><br><span class="line">ECHO IconIndex=150&gt;&gt;%%i\%n%</span><br><span class="line">)</span><br><span class="line">::删除本bat文件</span><br><span class="line">DEL /F %~s0</span><br></pre></td></tr></table></figure>
<blockquote>
<p>说明：IconIndex是快捷方式使用的图标的顺序号（此处为系统文件中的图标的顺序，位于以下的IconFile文件夹中，具体查看《Shell32.Dll 图标资源对照表》）。也可以通过自己机算得出。（更换图标时，4行，N列，从上到下再从做到右，1~N）</p>
</blockquote>
<h4 id="5秒后息屏"><a href="#5秒后息屏" class="headerlink" title="5秒后息屏"></a>5秒后息屏</h4><p><strong>配合WinKey+L，营造出一种长时间没动电脑的错觉</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">ping   -n   5   127.1   &gt;nul</span><br><span class="line">powershell (Add-Type <span class="string">'[DllImport(\"user32.dll\")]^public static extern int SendMessage(int hWnd, int hMsg, int wParam, int lParam);'</span> -Name a -Pas)::SendMessage(-1,0x0112,0xF170,2)</span><br></pre></td></tr></table></figure>

<h4 id="设置开机启动项-禁止开启项"><a href="#设置开机启动项-禁止开启项" class="headerlink" title="设置开机启动项\禁止开启项"></a>设置开机启动项\禁止开启项</h4><p><code>Aria2</code> 与 <code>%cd%\Start.vbs</code>  为可改动项，左边是名称，右边是启动文件路径</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">echo</span> 1.将 Aria2 设为开机启动</span><br><span class="line"><span class="built_in">echo</span> 2.取消 Aria2 开机启动</span><br><span class="line"><span class="built_in">set</span> /p aria2= 请输入对应的序号：</span><br><span class="line">IF %aria2% EQU 1 (REG ADD HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ /v Aria2  /t REG_SZ /d %<span class="built_in">cd</span>%\Start.vbs /f)</span><br><span class="line">IF %aria2% EQU 2 (REG DELETE HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ /v Aria2 /f)</span><br><span class="line">pause &gt; nul</span><br></pre></td></tr></table></figure>



<h4 id="复制当前目录的文件到其他文件夹"><a href="#复制当前目录的文件到其他文件夹" class="headerlink" title="复制当前目录的文件到其他文件夹"></a>复制当前目录的文件到其他文件夹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> | ---------------移动到启动文件夹，设置系统开机启动-------------- |</span><br><span class="line">//移动  “启动系统.bat” 文件 到 “启动文件夹”</span><br><span class="line">xcopy <span class="string">"%~dp0启动系统.bat"</span> <span class="string">"%programdata%\Microsoft\Windows\Start Menu\Programs\Startup"</span></span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<ul>
<li>文件和目标路径，最好加上 <code>“”</code>，否则会找不到文件，或者无效的参数数量</li>
<li>如果是访问遭到拒绝，则 右键-管理员模式打开</li>
</ul>
<h4 id="复制当前目录下的文件夹到其他文件夹"><a href="#复制当前目录下的文件夹到其他文件夹" class="headerlink" title="复制当前目录下的文件夹到其他文件夹"></a>复制当前目录下的文件夹到其他文件夹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//把<span class="string">"温馨提示"</span>文件夹 包含文件  ，复制到 D盘，并且新建一个<span class="string">"温馨提示勿删"</span>的文件夹</span><br><span class="line">xcopy <span class="string">"%~dp0温馨提示"</span> <span class="string">"D:\温馨提示勿删\" /e  /y /d </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/e 表示，复制E:\Blog\blog5\source\_posts下面的目录和子目录，包括空目录</span></span><br><span class="line"><span class="string">/y 表示，如果目标目录下有同名文件了，不询问，就直接覆盖。</span></span><br><span class="line"><span class="string">/d 对应同名文件，只复制那些源文件时间比目标文件时间新的那些文件。这样可以节省复制的操作。就不会全部一股脑的复制(覆盖)。</span></span><br></pre></td></tr></table></figure>

<h4 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h4><blockquote>
<p>必须管理员模式运行！</p>
<p>更多查看：<a href="https://www.jb51.net/article/134023.htm" target="_blank" rel="noopener">cmd 环境变量设置方法详细解释</a></p>
</blockquote>
<h5 id="简单bat方法"><a href="#简单bat方法" class="headerlink" title="简单bat方法"></a>简单bat方法</h5><p>添加到<strong>用户</strong>环境变量：<code>setx BAT_HOME C:\bat</code></p>
<p>添加到系统环境变量：<code>setx -M BAT_HOME C:\bat</code></p>
<h5 id="注册表方法"><a href="#注册表方法" class="headerlink" title="注册表方法"></a>注册表方法</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">::添加环境变量 BAT_HOME</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">echo</span> 添加 bat 环境变量</span><br><span class="line"><span class="built_in">set</span> regpath=HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment</span><br><span class="line"><span class="built_in">set</span> evname=BAT_HOME</span><br><span class="line"><span class="built_in">set</span> batpath=c:\bat</span><br><span class="line">reg add <span class="string">"%regpath%"</span> /v %evname% /d %batpath% /f</span><br><span class="line">pause&gt;nul</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">::删除环境变量 BAT_HOME</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">echo</span> 删除 bat 环境变量</span><br><span class="line"><span class="built_in">set</span> regpath=HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment</span><br><span class="line"><span class="built_in">set</span> evname=BAT_HOME</span><br><span class="line">reg delete <span class="string">"%regpath%"</span> /v <span class="string">"%evname%"</span>  /f</span><br><span class="line">pause&gt;nul</span><br></pre></td></tr></table></figure>





<h3 id="2-2-网络"><a href="#2-2-网络" class="headerlink" title="2.2 网络"></a>2.2 网络</h3><h4 id="获取本机MAC地址"><a href="#获取本机MAC地址" class="headerlink" title="获取本机MAC地址"></a>获取本机MAC地址</h4><h5 id="全部"><a href="#全部" class="headerlink" title="全部"></a>全部</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getmac /v &gt; mac.txt</span><br><span class="line"><span class="built_in">echo</span> GET MAC ADDRESS SUCCESS</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>

<h5 id="搜索正在用的"><a href="#搜索正在用的" class="headerlink" title="搜索正在用的"></a>搜索正在用的</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">getmac /v | find /i <span class="string">"Intel(R)"</span> &gt; mac.txt</span><br><span class="line">getmac /v | find /i <span class="string">"ASIX"</span> &gt;&gt; mac.txt</span><br><span class="line">getmac /v | find /i <span class="string">"Realtek"</span> &gt;&gt; mac.txt</span><br><span class="line">getmac /v | find /i <span class="string">"Qualcomm"</span> &gt;&gt; mac.txt</span><br><span class="line">start notepad <span class="string">"mac.txt"</span></span><br></pre></td></tr></table></figure>



<h4 id="设置固定IP"><a href="#设置固定IP" class="headerlink" title="设置固定IP"></a>设置固定IP</h4><p><strong>方法1</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">cls</span><br><span class="line">color 0A</span><br><span class="line">Echo *******************************************************************************</span><br><span class="line">Echo           正在修改IP地址和DNS服务器地址,请耐心等待…………</span><br><span class="line">Echo *******************************************************************************</span><br><span class="line">cmd /c netsh interface ip <span class="built_in">set</span> address name=<span class="string">"WLAN"</span> <span class="built_in">source</span>=static addr=192.168.10.193 mask=255.255.255.0 gateway=192.168.10.1 gwmetric=1</span><br><span class="line">cmd /c netsh interface ip <span class="built_in">set</span> dns name=<span class="string">"WLAN"</span> <span class="built_in">source</span>=static addr=202.101.224.69</span><br><span class="line">cmd /c netsh interface ip add dns name=<span class="string">"WLAN"</span> addr=202.101.226.69 index=2</span><br><span class="line">ipconfig /all</span><br><span class="line">Pause</span><br></pre></td></tr></table></figure>

<p><strong>方法2</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> //-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">@<span class="built_in">echo</span> //  【固定设置】</span><br><span class="line">@<span class="built_in">echo</span> //  设置IP，子网掩码，网关</span><br><span class="line">@<span class="built_in">echo</span> //-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">@<span class="built_in">echo</span> // 获取管理员权限</span><br><span class="line">%1 mshta vbscript:CreateObject(<span class="string">"Shell.Application"</span>).ShellExecute(<span class="string">"cmd.exe"</span>,<span class="string">"/c %~s0 ::"</span>,<span class="string">""</span>,<span class="string">"runas"</span>,1)(window.close)&amp;&amp;<span class="built_in">exit</span></span><br><span class="line"><span class="built_in">cd</span> /d <span class="string">"%~dp0"</span></span><br><span class="line">netsh interface ip <span class="built_in">set</span> address name=<span class="string">"WLAN"</span> <span class="built_in">source</span>=static addr=192.168.10.193 mask=255.255.255.0 gateway=192.168.10.1 </span><br><span class="line">@<span class="built_in">echo</span> //-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">@<span class="built_in">echo</span> //  设置DNS</span><br><span class="line">@<span class="built_in">echo</span> //-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">netsh interface ip <span class="built_in">set</span> dns <span class="string">"WLAN"</span> static 114.114.114.114 primary</span><br><span class="line">netsh interface ip add dns <span class="string">"WLAN"</span> 8.8.8.8</span><br><span class="line">@<span class="built_in">echo</span> //  固定IP设置完成！</span><br><span class="line">@pause</span><br></pre></td></tr></table></figure>

<h4 id="设置自动获取IP"><a href="#设置自动获取IP" class="headerlink" title="设置自动获取IP"></a>设置自动获取IP</h4><p><strong>方法1</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">cls</span><br><span class="line">color 0A</span><br><span class="line">Echo *******************************************************************************</span><br><span class="line">Echo           正在修改IP地址和DNS服务器地址,请耐心等待…………</span><br><span class="line">Echo *******************************************************************************</span><br><span class="line">netsh interface ip <span class="built_in">set</span> address name=<span class="string">"WLAN"</span> <span class="built_in">source</span>=dhcp</span><br><span class="line">netsh interface ip delete dns <span class="string">"WLAN"</span> all</span><br><span class="line">ipconfig /flushdns</span><br><span class="line">ipconfig /all</span><br><span class="line">Echo *******************************************************************************</span><br><span class="line">Echo          OK！！已修改成功！请按任意键继续…………</span><br><span class="line">Echo *******************************************************************************</span><br><span class="line">Pause</span><br></pre></td></tr></table></figure>

<p><strong>方法2</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> //-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">@<span class="built_in">echo</span> //  【自动获取】</span><br><span class="line">@<span class="built_in">echo</span> //  设置IP，子网掩码，网关</span><br><span class="line">@<span class="built_in">echo</span> //-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">@<span class="built_in">echo</span> // 获取管理员权限</span><br><span class="line">%1 mshta vbscript:CreateObject(<span class="string">"Shell.Application"</span>).ShellExecute(<span class="string">"cmd.exe"</span>,<span class="string">"/c %~s0 ::"</span>,<span class="string">""</span>,<span class="string">"runas"</span>,1)(window.close)&amp;&amp;<span class="built_in">exit</span></span><br><span class="line"><span class="built_in">cd</span> /d <span class="string">"%~dp0"</span></span><br><span class="line">netsh interface ip <span class="built_in">set</span> address name=<span class="string">"WLAN"</span> <span class="built_in">source</span>=dhcp </span><br><span class="line">@<span class="built_in">echo</span> //-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">@<span class="built_in">echo</span> //  设置DNS</span><br><span class="line">@<span class="built_in">echo</span> //-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">netsh interface ip <span class="built_in">set</span> dns name = <span class="string">"WLAN"</span> static addr = none</span><br><span class="line">@<span class="built_in">echo</span> //  自动获取IP设置完成！</span><br><span class="line">@pause</span><br></pre></td></tr></table></figure>
<h4 id="WIFI密码查看"><a href="#WIFI密码查看" class="headerlink" title="WIFI密码查看"></a>WIFI密码查看</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /f <span class="string">"skip=9 tokens=1,2 delims=:"</span> %i <span class="keyword">in</span> (<span class="string">'netsh wlan show profiles'</span>) <span class="keyword">do</span>  @<span class="built_in">echo</span> %j | findstr -i -v <span class="built_in">echo</span> | netsh wlan show profiles %j key=clear</span><br></pre></td></tr></table></figure>

<h4 id="查看以往WIFI密码"><a href="#查看以往WIFI密码" class="headerlink" title="查看以往WIFI密码"></a>查看以往WIFI密码</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">::MODE con: COLS=165 LINES=65</span><br><span class="line">title 查看WIFI密码 %date%</span><br><span class="line">::获取管理员权限</span><br><span class="line">setlocal</span><br><span class="line"><span class="built_in">set</span> uac=~uac_permission_tmp_%random%</span><br><span class="line">md <span class="string">"%SystemRoot%\system32\%uac%"</span> 2&gt;nul</span><br><span class="line"><span class="keyword">if</span> %errorlevel%==0 ( rd <span class="string">"%SystemRoot%\system32\%uac%"</span> &gt;nul 2&gt;nul ) <span class="keyword">else</span> (</span><br><span class="line">    <span class="built_in">echo</span> <span class="built_in">set</span> uac = CreateObject^(<span class="string">"Shell.Application"</span>^)&gt;<span class="string">"%temp%\%uac%.vbs"</span></span><br><span class="line">    <span class="built_in">echo</span> uac.ShellExecute <span class="string">"%~s0"</span>,<span class="string">""</span>,<span class="string">""</span>,<span class="string">"runas"</span>,1 &gt;&gt;<span class="string">"%temp%\%uac%.vbs"</span></span><br><span class="line">    <span class="built_in">echo</span> WScript.Quit &gt;&gt;<span class="string">"%temp%\%uac%.vbs"</span></span><br><span class="line">    <span class="string">"%temp%\%uac%.vbs"</span> /f</span><br><span class="line">    del /f /q <span class="string">"%temp%\%uac%.vbs"</span> &amp; <span class="built_in">exit</span> )</span><br><span class="line">endlocal</span><br><span class="line">:: ***********************************************************************  我是分割线</span><br><span class="line">netsh wlan show profile</span><br><span class="line"><span class="built_in">echo</span>   ************************************************************************</span><br><span class="line"><span class="built_in">echo</span>  提示:以上为本机所连接过WIFI信息</span><br><span class="line"><span class="built_in">echo</span>   ************************************************************************</span><br><span class="line">:menu</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line">  <span class="built_in">set</span> /p var=请输入你要查看密钥WLAN:</span><br><span class="line"><span class="keyword">if</span>  <span class="string">"%var%"</span>  equ  <span class="string">""</span>  goto  menu</span><br><span class="line"><span class="keyword">if</span>  %var%    equ 15  <span class="built_in">exit</span></span><br><span class="line">netsh wlan show profile name=<span class="string">"%var%"</span> key=clear &gt;kbc.txt</span><br><span class="line"><span class="built_in">type</span> kbc.txt | findstr 关键内容</span><br><span class="line">ping /n 10 127.0.0.1 &gt;nul</span><br></pre></td></tr></table></figure>



<h3 id="2-3-软件"><a href="#2-3-软件" class="headerlink" title="2.3 软件"></a>2.3 软件</h3><h4 id="微信多开方法"><a href="#微信多开方法" class="headerlink" title="微信多开方法"></a>微信多开方法</h4><ol>
<li>复制下面代码，建立bat文件</li>
<li>拷贝bat文件到微信根目录。</li>
<li>然后发送bat文件到桌面快捷方式</li>
<li>打开bat文件即可</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">//需要几个微信，就几行</span><br><span class="line">start /d <span class="string">"%~sdp0"</span> WeChat.exe</span><br><span class="line">start /d <span class="string">"%~sdp0"</span> WeChat.exe</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>





<h2 id="三、问题"><a href="#三、问题" class="headerlink" title="三、问题"></a>三、问题</h2><h3 id="Q1-导出时文件或者使用时，出现乱码"><a href="#Q1-导出时文件或者使用时，出现乱码" class="headerlink" title="Q1:导出时文件或者使用时，出现乱码"></a>Q1:导出时文件或者使用时，出现乱码</h3><p>A:用文本文件打开-另存为</p>
<ol>
<li>保存类型-所有文件</li>
<li>编码-改成ANSI</li>
<li><strong>保存即可</strong></li>
</ol>
<h3 id="Q2：命令没有错，但是就是找不到文件（中文文件）"><a href="#Q2：命令没有错，但是就是找不到文件（中文文件）" class="headerlink" title="Q2：命令没有错，但是就是找不到文件（中文文件）"></a>Q2：命令没有错，但是就是找不到文件（中文文件）</h3><p>A：用文本文件打开-另存为</p>
<ol>
<li>保存类型-所有文件</li>
<li>编码-改成ANSI</li>
<li><strong>保存即可</strong></li>
</ol>
<h3 id="Q3：访问遭到拒绝"><a href="#Q3：访问遭到拒绝" class="headerlink" title="Q3：访问遭到拒绝"></a>Q3：访问遭到拒绝</h3><h5 id="右键-管理员模式打开"><a href="#右键-管理员模式打开" class="headerlink" title="右键 - 管理员模式打开"></a>右键 - 管理员模式打开</h5></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Gkon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://gxkon.top/posts/1684f4d3/">http://gxkon.top/posts/1684f4d3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://gxkon.top" target="_blank">Gxkon's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/BAT%E6%89%B9%E5%A4%84%E7%90%86/">BAT批处理</a></div><div class="post_share"><div class="social-share" data-image="/Pic/post.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/posts/ab31d935/"><img class="prev_cover" data-src="https://tvax4.sinaimg.cn/large/4a9e9735gy1ge0jue9kc3j212w0pyac6.jpg" onerror="onerror=null;src='/Pic/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">斐讯N1刷各种系统</div></div></a></div><div class="next-post pull_right"><a href="/posts/7fd407bc/"><img class="next_cover" data-src="https://tvax3.sinaimg.cn/large/4a9e9735gy1gdus3cqr6oj20zk0obwio.jpg" onerror="onerror=null;src='/Pic/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">注册表和BAT批处理修改IE选项</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/posts/decfd2ee/" title="REG和BAT文件操作注册表方法"><img class="relatedPosts_cover" data-src="https://pic-1256641195.cos.ap-nanjing.myqcloud.com/2020/07/landscape-5363681_1280.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-07-09</div><div class="relatedPosts_title">REG和BAT文件操作注册表方法</div></div></a></div><div class="relatedPosts_item"><a href="/posts/7fd407bc/" title="注册表和BAT批处理修改IE选项"><img class="relatedPosts_cover" data-src="https://tvax3.sinaimg.cn/large/4a9e9735gy1gdus3cqr6oj20zk0obwio.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-15</div><div class="relatedPosts_title">注册表和BAT批处理修改IE选项</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '1ce3148e3133bf004c96',
  clientSecret: '2a1e5c0f4d38387460b916843bfe5cac67ef2d07',
  repo: 'blankwz.github.io',
  owner: 'blankwz',
  admin: ['blankwz'],
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN',
  perPage: 10,
  distractionFreeMode: false,
  pagerDirection: 'last',
  createIssueManually: false,
  updateCountCallback: commentCount
})
gitalk.render('gitalk-container')

function commentCount(n){
  try {
    document.getElementsByClassName('gitalk-comment-count')[0].innerHTML= n
  } catch (e) {
    return false
  }
}</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Gkon</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">簡</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/third-party/ClickShowText.js"></script></body></html>