<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Python文本处理之xml文件操作 | Gxkon's Blog</title><meta name="description" content="Python文本处理之xml文件操作 　XML 指可扩展标记语言（eXtensible Markup Language）， 被设计用来传输和存储数据。 python中有三个模块解析xml文件：DOM， ElementTree，SAX  一、XMLlxml最全面和权威的文档是其官方网站：lxml - Processing XML and HTML with Python,  从左侧的“Develop"><meta name="keywords" content="Python"><meta name="author" content="Gkon"><meta name="copyright" content="Gkon"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Python文本处理之xml文件操作"><meta name="twitter:description" content="Python文本处理之xml文件操作 　XML 指可扩展标记语言（eXtensible Markup Language）， 被设计用来传输和存储数据。 python中有三个模块解析xml文件：DOM， ElementTree，SAX  一、XMLlxml最全面和权威的文档是其官方网站：lxml - Processing XML and HTML with Python,  从左侧的“Develop"><meta name="twitter:image" content="http://gxkon.top/Pic/post.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Python文本处理之xml文件操作"><meta property="og:url" content="http://gxkon.top/posts/ec4e7dd/"><meta property="og:site_name" content="Gxkon's Blog"><meta property="og:description" content="Python文本处理之xml文件操作 　XML 指可扩展标记语言（eXtensible Markup Language）， 被设计用来传输和存储数据。 python中有三个模块解析xml文件：DOM， ElementTree，SAX  一、XMLlxml最全面和权威的文档是其官方网站：lxml - Processing XML and HTML with Python,  从左侧的“Develop"><meta property="og:image" content="http://gxkon.top/Pic/post.jpg"><meta property="article:published_time" content="2020-12-06T09:02:01.000Z"><meta property="article:modified_time" content="2021-01-23T12:12:21.440Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://gxkon.top/posts/ec4e7dd/"><link rel="prev" title="Python文本处理之PDF操作" href="http://gxkon.top/posts/aea9dc89/"><link rel="next" title="试玩IPv6与DDNS" href="http://gxkon.top/posts/ebbbbbf7/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5/js/md5.min.js"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"本人,超帅,打钱","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/Pic/avatar.png" onerror="onerror=null;src='/Pic/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">156</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">83</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">54</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 娱乐</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Python文本处理之xml文件操作"><span class="toc-text">Python文本处理之xml文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、XML"><span class="toc-text">一、XML</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、DOM"><span class="toc-text">二、DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-DOM写入xml文件"><span class="toc-text">1 DOM写入xml文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#示例"><span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-读取和更新xml文件"><span class="toc-text">2 读取和更新xml文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#示例-1"><span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-完整示例"><span class="toc-text">3 完整示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#报错：ModuleNotFoundError"><span class="toc-text">报错：ModuleNotFoundError</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、ElementTree"><span class="toc-text">三、ElementTree</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#导入"><span class="toc-text">导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#函数-模块方法"><span class="toc-text">函数 - 模块方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Element对象"><span class="toc-text">Element对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ElementTree-对象"><span class="toc-text">ElementTree 对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例1-这个很重要，玩懂这个，就差不多了"><span class="toc-text">示例1 - 这个很重要，玩懂这个，就差不多了</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#xml文件"><span class="toc-text">xml文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#操作"><span class="toc-text">操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例2"><span class="toc-text">示例2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-读取和解析xml文件"><span class="toc-text">1 读取和解析xml文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-创建xml文件并写入"><span class="toc-text">2 创建xml文件并写入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-读取并更新结点"><span class="toc-text">3 读取并更新结点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-添加子元素"><span class="toc-text">4 添加子元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-删除子元素"><span class="toc-text">5 删除子元素</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例3"><span class="toc-text">示例3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#xml文件-1"><span class="toc-text">xml文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#操作-1"><span class="toc-text">操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取XML中的元素"><span class="toc-text">获取XML中的元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#解析XML名称空间"><span class="toc-text">解析XML名称空间</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、SAX-Simple-API-for-XML"><span class="toc-text">三、SAX(Simple API for XML)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#解析器"><span class="toc-text">解析器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#事件处理器"><span class="toc-text">事件处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例-2"><span class="toc-text">示例</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/Pic/post.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Gxkon's Blog</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 娱乐</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Python文本处理之xml文件操作</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-12-06 17:02:01"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-12-06</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2021-01-23 20:12:21"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2021-01-23</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Python/">Python</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Python/%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/">文本处理</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/posts/ec4e7dd/#post-comment"><span class="gitalk-comment-count comment-count"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="Python文本处理之xml文件操作"><a href="#Python文本处理之xml文件操作" class="headerlink" title="Python文本处理之xml文件操作"></a>Python文本处理之xml文件操作</h1><blockquote>
<p>　XML 指可扩展标记语言（eXtensible Markup Language）， 被设计用来传输和存储数据。</p>
<p>python中有三个模块解析xml文件：<code>DOM， ElementTree，SAX</code></p>
</blockquote>
<h2 id="一、XML"><a href="#一、XML" class="headerlink" title="一、XML"></a>一、XML</h2><p>lxml最全面和权威的文档是其官方网站：<a href="https://link.zhihu.com/?target=http%3A//lxml.de/">lxml - Processing XML and HTML with Python</a>,</p>
<ul>
<li>从左侧的“Developing with lxml” 下面的内容开始看</li>
</ul>
<p><strong>三种解析方式</strong>：</p>
<ol>
<li><p>DOM</p>
<ul>
<li>W3C定义了DOM模型里的概念，<a href="https://link.zhihu.com/?target=http%3A//www.w3school.com.cn/xmldom/index.asp">XML DOM 教程</a></li>
</ul>
</li>
<li><p>ElementTree 是一个适合python的XML模型，更简单、灵活，Python专有</p>
<ul>
<li>与DOM相比，在python里，除非有非用DOM不可的理由，否则<code>etree总是应该优先考虑</code></li>
<li>见 <a href="https://link.zhihu.com/?target=http%3A//stackoverflow.com/questions/11952713/xml-etree-or-xml-dom">xml.etree or xml.dom?</a></li>
</ul>
</li>
<li><p>SAX是一种基于事件的流式处理模型，可以在只读入部分XML的情况下进行处理</p>
<ul>
<li>DOM与etree模型都是内存模型，需要将XML完整读入内存后才能使用</li>
<li>如果情况许可，DOM与etree一般都比SAX简单。</li>
<li>但是在一些情况下，如<strong>XML巨大，速度要求高等，SAX</strong>基本就是唯一的选择了。</li>
</ul>
</li>
</ol>
<h2 id="二、DOM"><a href="#二、DOM" class="headerlink" title="二、DOM"></a>二、DOM</h2><p> <strong>DOM(Document Object Model)</strong>是个跨平台的标准模型，W3C定义了<a href="https://www.w3school.com.cn/xmldom/index.asp" target="_blank" rel="noopener">DOM模型</a>里的概念</p>
<p>更多看：<a href="https://www.cnblogs.com/hupeng1234/p/7262371.html" target="_blank" rel="noopener">python 使用ElementTree解析xml</a></p>
<h3 id="1-DOM写入xml文件"><a href="#1-DOM写入xml文件" class="headerlink" title="1 DOM写入xml文件"></a><strong>1 DOM写入xml文件</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">doc = minidom.Document()  <span class="comment">#创建树</span></span><br><span class="line">doc.createElement(<span class="string">"folder"</span>)  <span class="comment">#创建名为folder的结点</span></span><br><span class="line">doc.createTextNode(<span class="string">'user'</span>)   <span class="comment">#创建文本结点，文本为 user</span></span><br><span class="line">root_node.appendChild(folder_node) <span class="comment">#root_node结点添加folder_node为子节点book_node.setAttribute('price','199')  #book_node设置属性值</span></span><br><span class="line"><span class="comment"># 每一个结点对象（包括dom对象本身）都有输出XML内容的方法，如：toxml()--字符串, toprettyxml()--美化树形格式。 doc.toxml(encoding="utf-8") # 输出字符串 doc.toprettyxml(indent='', addindent='\t', newl='\n', encoding="utf-8")) #输出带格式的字符串 doc.writexml() #将prettyxml字符串写入文件</span></span><br></pre></td></tr></table></figure>

<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">def write_xml():</span><br><span class="line">    <span class="comment">#1. 创建dom树对象</span></span><br><span class="line">    doc = minidom.Document()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#2. 创建根结点，并用dom对象添加根结点</span></span><br><span class="line">    root_node = doc.createElement(<span class="string">"annotation"</span>)</span><br><span class="line">    doc.appendChild(root_node)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#3. 创建结点，结点包含一个文本结点, 再将结点加入到根结点</span></span><br><span class="line">    folder_node = doc.createElement(<span class="string">"folder"</span>)</span><br><span class="line">    folder_value = doc.createTextNode(<span class="string">'user'</span>)</span><br><span class="line">    folder_node.appendChild(folder_value)</span><br><span class="line">    root_node.appendChild(folder_node)</span><br><span class="line"></span><br><span class="line">    filename_node = doc.createElement(<span class="string">"filename"</span>)</span><br><span class="line">    filename_value = doc.createTextNode(<span class="string">'0000001.jpg'</span>)</span><br><span class="line">    filename_node.appendChild(filename_value)</span><br><span class="line">    root_node.appendChild(filename_node)</span><br><span class="line"></span><br><span class="line">    path_node = doc.createElement(<span class="string">"path"</span>)</span><br><span class="line">    path_value = doc.createTextNode(<span class="string">'/home'</span>)</span><br><span class="line">    path_node.appendChild(path_value)</span><br><span class="line">    root_node.appendChild(path_node)</span><br><span class="line"></span><br><span class="line">    source_node = doc.createElement(<span class="string">"source"</span>)</span><br><span class="line">    database_node = doc.createElement(<span class="string">"database"</span>)</span><br><span class="line">    database_node.appendChild(doc.createTextNode(<span class="string">"Unknown"</span>))</span><br><span class="line">    source_node.appendChild(database_node)</span><br><span class="line">    root_node.appendChild(source_node)</span><br><span class="line"></span><br><span class="line">    size_node = doc.createElement(<span class="string">"size"</span>)</span><br><span class="line">    <span class="keyword">for</span> item, value <span class="keyword">in</span> zip([<span class="string">"width"</span>, <span class="string">"height"</span>, <span class="string">"depth"</span>], [1920, 1080, 3]):</span><br><span class="line">        elem = doc.createElement(item)</span><br><span class="line">        elem.appendChild(doc.createTextNode(str(value)))</span><br><span class="line">        size_node.appendChild(elem)</span><br><span class="line">    root_node.appendChild(size_node)</span><br><span class="line"></span><br><span class="line">    seg_node = doc.createElement(<span class="string">"segmented"</span>)</span><br><span class="line">    seg_node.appendChild(doc.createTextNode(str(0)))</span><br><span class="line">    root_node.appendChild(seg_node)</span><br><span class="line"></span><br><span class="line">    obj_node = doc.createElement(<span class="string">"object"</span>)</span><br><span class="line">    name_node = doc.createElement(<span class="string">"name"</span>)</span><br><span class="line">    name_node.appendChild(doc.createTextNode(<span class="string">"boat"</span>))</span><br><span class="line">    obj_node.appendChild(name_node)</span><br><span class="line"></span><br><span class="line">    pose_node = doc.createElement(<span class="string">"pose"</span>)</span><br><span class="line">    pose_node.appendChild(doc.createTextNode(<span class="string">"Unspecified"</span>))</span><br><span class="line">    obj_node.appendChild(pose_node)</span><br><span class="line"></span><br><span class="line">    trun_node = doc.createElement(<span class="string">"truncated"</span>)</span><br><span class="line">    trun_node.appendChild(doc.createTextNode(str(1)))</span><br><span class="line">    obj_node.appendChild(trun_node)</span><br><span class="line"></span><br><span class="line">    trun_node = doc.createElement(<span class="string">"difficult"</span>)</span><br><span class="line">    trun_node.appendChild(doc.createTextNode(str(0)))</span><br><span class="line">    obj_node.appendChild(trun_node)</span><br><span class="line"></span><br><span class="line">    bndbox_node = doc.createElement(<span class="string">"bndbox"</span>)</span><br><span class="line">    <span class="keyword">for</span> item, value <span class="keyword">in</span> zip([<span class="string">"xmin"</span>, <span class="string">"ymin"</span>, <span class="string">"xmax"</span>, <span class="string">"ymax"</span>], [103, 1, 634, 402]):</span><br><span class="line">        elem = doc.createElement(item)</span><br><span class="line">        elem.appendChild(doc.createTextNode(str(value)))</span><br><span class="line">        bndbox_node.appendChild(elem)</span><br><span class="line">    obj_node.appendChild(bndbox_node)</span><br><span class="line">    root_node.appendChild(obj_node)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    with open(<span class="string">"0000001.xml"</span>, <span class="string">"w"</span>, encoding=<span class="string">"utf-8"</span>) as f:</span><br><span class="line">        <span class="comment"># 4.writexml()第一个参数是目标文件对象，第二个参数是根节点的缩进格式，第三个参数是其他子节点的缩进格式，</span></span><br><span class="line">        <span class="comment"># 第四个参数制定了换行格式，第五个参数制定了xml内容的编码。</span></span><br><span class="line">        doc.writexml(f, indent=<span class="string">''</span>, addindent=<span class="string">'\t'</span>, newl=<span class="string">'\n'</span>, encoding=<span class="string">"utf-8"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 每一个结点对象（包括dom对象本身）都有输出XML内容的方法，如：toxml()--字符串, toprettyxml()--美化树形格式。</span></span><br><span class="line">    <span class="comment"># print(doc.toxml(encoding="utf-8"))  # 输出字符串</span></span><br><span class="line">    <span class="comment"># print(doc.toprettyxml(indent='', addindent='\t', newl='\n', encoding="utf-8"))   #输出带格式的字符串</span></span><br><span class="line">    <span class="comment"># doc.writexml() #将prettyxml字符串写入文件</span></span><br></pre></td></tr></table></figure>

<h3 id="2-读取和更新xml文件"><a href="#2-读取和更新xml文件" class="headerlink" title="2 读取和更新xml文件"></a><strong>2 读取和更新xml文件</strong></h3><p>解析xml文件为DOM树，获取树的根节点，随后即可通过根节点寻找相关的子节点，并获取相关的属性和文本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">doc = minidom.parse(xml_path)  <span class="comment">#解析xml文件(句柄或文件路径)</span></span><br><span class="line">doc = minidom.parseString()  <span class="comment">#解析xml字符串</span></span><br><span class="line">root_node = doc.documentElement  <span class="comment">#获得根节点</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(root_node.nodeName)      <span class="comment">#结点名称</span></span><br><span class="line"><span class="built_in">print</span>(root_node.nodeType)       <span class="comment">#结点类型  （元素结点，文本结点，属性结点）</span></span><br><span class="line"><span class="built_in">print</span>(root_node.childNodes)     <span class="comment">#所有子节点，为列表</span></span><br><span class="line"><span class="built_in">print</span>(node.parentNode)       <span class="comment"># 获取父节点</span></span><br><span class="line">filename_node = root_node.getElementsByTagName(<span class="string">'filename'</span>)[0]  <span class="comment">#通过结点名称寻找结点，返回列表#文本结点</span></span><br><span class="line">filename = filename_node.childNodes[0].data  <span class="comment">#子节点为文本结点，文本结点有data属性即为文本值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#属性结点</span></span><br><span class="line"><span class="comment"># node.getAttribute('price')   #属性结点node，获取其price属性</span></span><br></pre></td></tr></table></figure>

<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">def read_xml(xml_path):</span><br><span class="line">    with open(xml_path, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) as f:</span><br><span class="line">        doc = minidom.parse(xml_path)  <span class="comment">#解析xml文件(句柄或文件路径)</span></span><br><span class="line">        <span class="comment">#doc = minidom.parseString()  #解析xml字符串</span></span><br><span class="line">        root_node = doc.documentElement  <span class="comment">#获得根节点</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#找到xmin结点并更新其对应的文本值</span></span><br><span class="line">        xmin_node = root_node.getElementsByTagName(<span class="string">"xmin"</span>)[0]</span><br><span class="line">        <span class="built_in">print</span>(xmin_node.childNodes[0].data)</span><br><span class="line">        xmin_node.childNodes[0].data = str(200)</span><br><span class="line">        <span class="built_in">print</span>(xmin_node.childNodes[0].data)</span><br><span class="line"></span><br><span class="line">    with open(xml_path, <span class="string">"w"</span>, encoding=<span class="string">"utf-8"</span>) as f:</span><br><span class="line">        doc.writexml(f)</span><br></pre></td></tr></table></figure>

<h3 id="3-完整示例"><a href="#3-完整示例" class="headerlink" title="3 完整示例"></a>3 完整示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span>  xml.dom <span class="keyword">import</span> minidom</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">https://www.cnblogs.com/silence-cho/p/12542747.html</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xmlrw</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_xml</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment">#1. 创建dom树对象</span></span><br><span class="line">        doc = minidom.Document()</span><br><span class="line"></span><br><span class="line">        <span class="comment">#2. 创建根结点，并用dom对象添加根结点</span></span><br><span class="line">        root_node = doc.createElement(<span class="string">"annotation"</span>) </span><br><span class="line">        doc.appendChild(root_node) <span class="comment"># &lt;annotation&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#3. 创建结点，结点包含一个文本结点, 再将结点加入到根结点</span></span><br><span class="line">        folder_node = doc.createElement(<span class="string">"folder"</span>)</span><br><span class="line">        folder_value = doc.createTextNode(<span class="string">'user'</span>)  </span><br><span class="line">        folder_node.appendChild(folder_value)  <span class="comment"># &lt;folder&gt;user&lt;/folder&gt;</span></span><br><span class="line">        root_node.appendChild(folder_node) <span class="comment"># 添加到根节点</span></span><br><span class="line"></span><br><span class="line">        filename_node = doc.createElement(<span class="string">"filename"</span>)</span><br><span class="line">        filename_value = doc.createTextNode(<span class="string">'0000001.jpg'</span>)</span><br><span class="line">        filename_node.appendChild(filename_value) <span class="comment"># &lt;filename&gt;0000001.jpg&lt;/filename&gt;</span></span><br><span class="line">        root_node.appendChild(filename_node)</span><br><span class="line"></span><br><span class="line">        path_node = doc.createElement(<span class="string">"path"</span>)</span><br><span class="line">        path_value = doc.createTextNode(<span class="string">'/home'</span>) </span><br><span class="line">        path_node.appendChild(path_value) <span class="comment"># &lt;path&gt;/home&lt;/path&gt;</span></span><br><span class="line">        root_node.appendChild(path_node)</span><br><span class="line"></span><br><span class="line">        source_node = doc.createElement(<span class="string">"source"</span>) <span class="comment"># &lt;source&gt;</span></span><br><span class="line">        database_node = doc.createElement(<span class="string">"database"</span>)</span><br><span class="line">        database_node.appendChild(doc.createTextNode(<span class="string">"Unknown"</span>)) <span class="comment"># &lt;database&gt;Unknown&lt;/database&gt;</span></span><br><span class="line">        source_node.appendChild(database_node) <span class="comment"># 添加到 &lt;source&gt; 下</span></span><br><span class="line">        root_node.appendChild(source_node)</span><br><span class="line"></span><br><span class="line">        size_node = doc.createElement(<span class="string">"size"</span>)</span><br><span class="line">        <span class="keyword">for</span> item, value <span class="keyword">in</span> zip([<span class="string">"width"</span>, <span class="string">"height"</span>, <span class="string">"depth"</span>], [<span class="number">1920</span>, <span class="number">1080</span>, <span class="number">3</span>]):</span><br><span class="line">            elem = doc.createElement(item)</span><br><span class="line">            elem.appendChild(doc.createTextNode(str(value)))</span><br><span class="line">            size_node.appendChild(elem)</span><br><span class="line">        root_node.appendChild(size_node)</span><br><span class="line">        <span class="string">"""&lt;size&gt;</span></span><br><span class="line"><span class="string">            &lt;width&gt;1920&lt;/width&gt;</span></span><br><span class="line"><span class="string">            &lt;height&gt;1080&lt;/height&gt;</span></span><br><span class="line"><span class="string">            &lt;depth&gt;3&lt;/depth&gt;</span></span><br><span class="line"><span class="string">        &lt;/size&gt;</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"></span><br><span class="line">        seg_node = doc.createElement(<span class="string">"segmented"</span>)</span><br><span class="line">        seg_node.appendChild(doc.createTextNode(str(<span class="number">0</span>))) <span class="comment"># &lt;segmented&gt;0&lt;/segmented&gt;</span></span><br><span class="line">        root_node.appendChild(seg_node) </span><br><span class="line">        <span class="string">"""&lt;object&gt;</span></span><br><span class="line"><span class="string">            &lt;name&gt;boat&lt;/name&gt;</span></span><br><span class="line"><span class="string">            &lt;pose&gt;Unspecified&lt;/pose&gt;</span></span><br><span class="line"><span class="string">            &lt;truncated&gt;1&lt;/truncated&gt;</span></span><br><span class="line"><span class="string">            &lt;difficult&gt;0&lt;/difficult&gt;</span></span><br><span class="line"><span class="string">            &lt;bndbox&gt;</span></span><br><span class="line"><span class="string">                &lt;xmin&gt;103&lt;/xmin&gt;</span></span><br><span class="line"><span class="string">                &lt;ymin&gt;1&lt;/ymin&gt;</span></span><br><span class="line"><span class="string">                &lt;xmax&gt;634&lt;/xmax&gt;</span></span><br><span class="line"><span class="string">                &lt;ymax&gt;402&lt;/ymax&gt;</span></span><br><span class="line"><span class="string">            &lt;/bndbox&gt;</span></span><br><span class="line"><span class="string">        &lt;/object&gt;</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        obj_node = doc.createElement(<span class="string">"object"</span>)</span><br><span class="line">        name_node = doc.createElement(<span class="string">"name"</span>)</span><br><span class="line">        name_node.appendChild(doc.createTextNode(<span class="string">"boat"</span>))</span><br><span class="line">        obj_node.appendChild(name_node)</span><br><span class="line"></span><br><span class="line">        pose_node = doc.createElement(<span class="string">"pose"</span>)</span><br><span class="line">        pose_node.appendChild(doc.createTextNode(<span class="string">"Unspecified"</span>))</span><br><span class="line">        obj_node.appendChild(pose_node)</span><br><span class="line"></span><br><span class="line">        trun_node = doc.createElement(<span class="string">"truncated"</span>)</span><br><span class="line">        trun_node.appendChild(doc.createTextNode(str(<span class="number">1</span>)))</span><br><span class="line">        obj_node.appendChild(trun_node)</span><br><span class="line"></span><br><span class="line">        trun_node = doc.createElement(<span class="string">"difficult"</span>)</span><br><span class="line">        trun_node.appendChild(doc.createTextNode(str(<span class="number">0</span>)))</span><br><span class="line">        obj_node.appendChild(trun_node)</span><br><span class="line"></span><br><span class="line">        bndbox_node = doc.createElement(<span class="string">"bndbox"</span>)</span><br><span class="line">        <span class="keyword">for</span> item, value <span class="keyword">in</span> zip([<span class="string">"xmin"</span>, <span class="string">"ymin"</span>, <span class="string">"xmax"</span>, <span class="string">"ymax"</span>], [<span class="number">103</span>, <span class="number">1</span>, <span class="number">634</span>, <span class="number">402</span>]):</span><br><span class="line">            elem = doc.createElement(item)</span><br><span class="line">            elem.appendChild(doc.createTextNode(str(value)))</span><br><span class="line">            bndbox_node.appendChild(elem)</span><br><span class="line">        obj_node.appendChild(bndbox_node)</span><br><span class="line">        root_node.appendChild(obj_node)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 写入</span></span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">"0000001.xml"</span>, <span class="string">"w"</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="comment"># 4.writexml()第一个参数是目标文件对象，第二个参数是根节点的缩进格式，第三个参数是其他子节点的缩进格式，</span></span><br><span class="line">            <span class="comment"># 第四个参数制定了换行格式，第五个参数制定了xml内容的编码。</span></span><br><span class="line">            doc.writexml(f, indent=<span class="string">''</span>, addindent=<span class="string">'\t'</span>, newl=<span class="string">'\n'</span>, encoding=<span class="string">"utf-8"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 每一个结点对象（包括dom对象本身）都有输出XML内容的方法，如：toxml()--字符串, toprettyxml()--美化树形格式。</span></span><br><span class="line">        <span class="comment"># print(doc.toxml(encoding="utf-8"))  # 输出字符串</span></span><br><span class="line">        <span class="comment"># print(doc.toprettyxml(indent='', addindent='\t', newl='\n', encoding="utf-8"))   #输出带格式的字符串</span></span><br><span class="line">        <span class="comment"># doc.writexml() #将prettyxml字符串写入文件</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(self,xml_path)</span>:</span>   </span><br><span class="line">        <span class="comment">#with open(xml_path, "r", encoding="utf-8") as f:</span></span><br><span class="line">        doc = minidom.parse(xml_path)  <span class="comment">#解析xml文件(句柄或文件路径)</span></span><br><span class="line">        <span class="comment">#doc = minidom.parseString()  #解析xml字符串</span></span><br><span class="line">        root_node = doc.documentElement  <span class="comment">#获得根节点</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#找到xmin结点并更新其对应的文本值</span></span><br><span class="line">        xmin_node = root_node.getElementsByTagName(<span class="string">"object"</span>)[<span class="number">0</span>]</span><br><span class="line">        print(xmin_node.childNodes[<span class="number">0</span>].data)</span><br><span class="line">        xmin_node.childNodes[<span class="number">0</span>].data = str(<span class="number">200</span>)</span><br><span class="line">        print(xmin_node.childNodes[<span class="number">0</span>].data)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># with open(xml_path, "w", encoding="utf-8") as f:</span></span><br><span class="line">        <span class="comment">#     doc.writexml(f)</span></span><br><span class="line">        print(<span class="string">"========================"</span>)</span><br><span class="line">        print(<span class="string">"1========================"</span>,root_node.nodeName)      <span class="comment">#结点名称</span></span><br><span class="line">        print(<span class="string">"2========================"</span>,root_node.nodeType)       <span class="comment">#结点类型  （元素结点，文本结点，属性结点）</span></span><br><span class="line">        print(<span class="string">"3========================"</span>,root_node.childNodes)     <span class="comment">#所有子节点，为列表</span></span><br><span class="line">        <span class="comment">#print(node.parentNode)       # 获取父节点</span></span><br><span class="line">        filename_node = root_node.getElementsByTagName(<span class="string">'filename'</span>)[<span class="number">0</span>]  <span class="comment">#通过结点名称寻找结点，返回列表</span></span><br><span class="line">        print(<span class="string">"4========================"</span>,filename_node)</span><br><span class="line">        <span class="comment">#文本结点</span></span><br><span class="line">        filename = filename_node.childNodes[<span class="number">0</span>].data  <span class="comment">#子节点为文本结点，文本结点有data属性即为文本值</span></span><br><span class="line">        print(<span class="string">"5========================"</span>,filename)</span><br><span class="line">        <span class="comment">#属性结点</span></span><br><span class="line">        <span class="comment"># node.getAttribute('price')   #属性结点node，获取其price属性</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="comment">#write_xml()</span></span><br><span class="line">    x = xmlrw()</span><br><span class="line">    x.read(<span class="string">'0000001.xml'</span>)</span><br></pre></td></tr></table></figure>



<h3 id="报错：ModuleNotFoundError"><a href="#报错：ModuleNotFoundError" class="headerlink" title="报错：ModuleNotFoundError"></a><em>报错：ModuleNotFoundError</em></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">报错：ModuleNotFoundError: No module named <span class="string">'xml.dom'</span>; <span class="string">'xml'</span> is not a package</span><br><span class="line">原来是我此文件的命名是 xml.py，造成错误！</span><br><span class="line">解决方法：把你的py程序文件名改掉即可。比如xml2.py</span><br></pre></td></tr></table></figure>



<h2 id="三、ElementTree"><a href="#三、ElementTree" class="headerlink" title="三、ElementTree"></a>三、<strong>ElementTree</strong></h2><p>ElementTree就像一个轻量级的DOM, Python专有，使用起来更加简单</p>
<ul>
<li><p>Element类型是一种灵活的容器对象，用于在内存中存储结构化数据。</p>
</li>
<li><p>每个element对象都具有以下属性：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. tag：string对象，表示数据代表的种类。</span><br><span class="line">2. attrib：dictionary对象，表示附有的属性。</span><br><span class="line">3. text：string对象，表示element的内容。</span><br><span class="line">4. tail：string对象，表示element闭合之后的尾迹。</span><br><span class="line">5. 若干子元素（child elements）。</span><br><span class="line"></span><br><span class="line">&lt;tag attrib1=1&gt;text&lt;/tag&gt;tail</span><br><span class="line">  1     2        3         4</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python3.3之后ElementTree模块会自动寻找可用的C库来加快速度</span></span><br><span class="line">try:</span><br><span class="line">    import xml.etree.cElementTree as ET</span><br><span class="line">except ImportError:</span><br><span class="line">    import xml.etree.ElementTree as ET</span><br></pre></td></tr></table></figure>

<h3 id="函数-模块方法"><a href="#函数-模块方法" class="headerlink" title="函数 - 模块方法"></a>函数 - 模块方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">.Comment(text=<span class="literal">None</span>)</span><br><span class="line">创建一个特别的element，通过标准序列化使其代表了一个comment。comment可以为bytestring或unicode。</span><br><span class="line"> </span><br><span class="line">.dump(elem)</span><br><span class="line">生成一个element tree，通过sys.stdout输出，elem可以是元素树或单个元素。这个方法只用于debug。</span><br><span class="line"> </span><br><span class="line">.fromstring(text)</span><br><span class="line">text是一个包含XML数据的字符串，与XML()方法类似，返回一个Element实例。</span><br><span class="line"> </span><br><span class="line">.fromstringlist(sequence, parser=<span class="literal">None</span>)</span><br><span class="line">从字符串的序列对象中解析xml文档。缺省parser为XMLParser，返回Element实例。</span><br><span class="line">New <span class="keyword">in</span> version <span class="number">2.7</span>.</span><br><span class="line"> </span><br><span class="line">.iselement(element)</span><br><span class="line">检查是否是一个element对象。</span><br><span class="line"> </span><br><span class="line">.iterparse(source, events=<span class="literal">None</span>, parser=<span class="literal">None</span>)</span><br><span class="line">将文件或包含xml数据的文件对象递增解析为element tree，并且报告进度。events是一个汇报列表，如果忽略，将只有end事件会汇报出来。</span><br><span class="line">注意，iterparse()只会在看见开始标签的<span class="string">"&gt;"</span>符号时才会抛出start事件，因此届时属性是已经定义了，但是text和tail属性在那时还没有定义，同样子元素也没有定义，因此他们可能不能被显示出来。如果你想要完整的元素，请查找end事件。</span><br><span class="line"> </span><br><span class="line">.parse(source, parser=<span class="literal">None</span>)</span><br><span class="line">将一个文件或者字符串解析为element tree。</span><br><span class="line"> </span><br><span class="line">.ProcessingInstruction(target, text=<span class="literal">None</span>)</span><br><span class="line">这个方法会创建一个特别的element，该element被序列化为一个xml处理命令。</span><br><span class="line"> </span><br><span class="line">.register_namespace(prefix, uri)</span><br><span class="line">注册命名空间前缀。这个注册是全局有效，任何已经给出的前缀或者命名空间uri的映射关系会被删除。</span><br><span class="line">New <span class="keyword">in</span> version <span class="number">2.7</span>.</span><br><span class="line"> </span><br><span class="line">.SubElement(parent, tag, attrib=&#123;&#125;, **extra)</span><br><span class="line">此函数是一个Subelement工厂，这个函数用于创建 element 实例，并将其添加到现有的 element 中。</span><br><span class="line"> </span><br><span class="line">.tostring(element, encoding=<span class="string">"us-ascii"</span>, method=<span class="string">"xml"</span>)</span><br><span class="line">转化为字符串。包括所有子元素 (返回包含了xml数据的字符串。)</span><br><span class="line"><span class="number">01.</span>element:表示一个element实例</span><br><span class="line"><span class="number">02.</span>encoding:默认编码是<span class="string">"us-ascii"</span></span><br><span class="line"><span class="number">03.</span>method:默认是<span class="string">"xml"</span>，可以选择“html”、“text”</span><br><span class="line"></span><br><span class="line">.tostringlist(element, encoding=<span class="string">"us-ascii"</span>, method=<span class="string">"xml"</span>)</span><br><span class="line">同上，转换为字符串列表</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">.XML(text, parser=<span class="literal">None</span>)</span><br><span class="line">从一个字符串常量中解析出xml片段。</span><br><span class="line"><span class="number">01.</span>text :包含xml数据的字符串。</span><br><span class="line"><span class="number">02.</span>parser:解析器默认是XMLParser</span><br><span class="line"><span class="number">03.</span>返回的是一个Element实例</span><br><span class="line"></span><br><span class="line">.XMLID(text, parser=<span class="literal">None</span>)</span><br><span class="line">从字符串常量解析出xml片段，同时返回一个字典，用以映射element的id到其自身。</span><br></pre></td></tr></table></figure>





<h3 id="Element对象"><a href="#Element对象" class="headerlink" title="Element对象"></a><strong>Element</strong>对象</h3><ul>
<li><p>作为一个Element对象，本身是具有子元素，因此可以直接对Element进行迭代取值</p>
</li>
<li><p><strong>Element中的遍历与查询</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Element.iter(tag=None)：遍历该Element所有后代，也可以指定tag进行遍历寻找。</span><br><span class="line">Element.findall(path)：查找当前元素下tag或path能够匹配的直系节点。</span><br><span class="line">Element.find(path)：查找当前元素下tag或path能够匹配的首个直系节点。</span><br><span class="line">Element.text: 获取当前元素的text值。</span><br><span class="line">Element.get(key, default=None)：获取元素指定key对应的属性值，如果没有该属性，则返回default值。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(tree.find(<span class="string">"folder"</span>))  <span class="comment">#在当前结点的子节点中寻找标签为folder的子节点</span></span><br><span class="line">    <span class="built_in">print</span>(tree.find(<span class="string">".//name"</span>)) <span class="comment">#寻找所有子孙结点中第一个标签为name的子节点</span></span><br><span class="line">    <span class="built_in">print</span>(tree.findall(<span class="string">".//name"</span>))  <span class="comment">#寻找所有子孙结点中标签为name的子节点（返回列表）</span></span><br><span class="line">    <span class="built_in">print</span>(tree.findtext(<span class="string">".//name"</span>))  <span class="comment">#寻找所有子孙结点中第一个标签为name的子节点，并返回其text属性</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>支持XPath的一小部分缩写语法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import xml.etree.ElementTree as ET</span><br><span class="line"></span><br><span class="line">root = ET.fromstring(countrydata)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Top-level elements</span></span><br><span class="line">root.findall(<span class="string">"."</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># All 'neighbor' grand-children of 'country' children of the top-level</span></span><br><span class="line"><span class="comment"># elements</span></span><br><span class="line">root.findall(<span class="string">"./country/neighbor"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Nodes with name='Singapore' that have a 'year' child</span></span><br><span class="line">root.findall(<span class="string">".//year/..[@name='Singapore']"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 'year' nodes that are children of nodes with name='Singapore'</span></span><br><span class="line">root.findall(<span class="string">".//*[@name='Singapore']/year"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># All 'neighbor' nodes that are the second child of their parent</span></span><br><span class="line">root.findall(<span class="string">".//neighbor[2]"</span>)</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>文档</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">class xml.etree.ElementTree.Element(tag, attrib=&#123;&#125;, **extra)</span><br><span class="line"></span><br><span class="line">　　tag：string，元素代表的数据种类。</span><br><span class="line">　　text：string，元素的内容。</span><br><span class="line">　　tail：string，元素的尾形。</span><br><span class="line">　　attrib：dictionary，元素的属性字典。</span><br><span class="line">　　</span><br><span class="line">　　＃针对属性的操作</span><br><span class="line">　　clear()：清空元素的后代、属性、text和tail也设置为None。</span><br><span class="line">　　get(key, default=None)：获取key对应的属性值，如该属性不存在则返回default值。</span><br><span class="line">　　items()：根据属性字典返回一个列表，列表元素为(key, value）。</span><br><span class="line">　　keys()：返回包含所有元素属性键的列表。</span><br><span class="line">　　<span class="built_in">set</span>(key, value)：设置新的属性键与值。</span><br><span class="line"></span><br><span class="line">　　＃针对后代的操作</span><br><span class="line">　　append(subelement)：添加直系子元素。（将元素子元素添加到元素的子元素内部列表的末尾）</span><br><span class="line">　　extend(subelements)：增加一串元素对象作为子元素。＃python2.7新特性</span><br><span class="line">　　find(match)：寻找第一个匹配子元素，匹配对象可以为tag或path。</span><br><span class="line">　　findall(match)：寻找所有匹配子元素，匹配对象可以为tag或path。</span><br><span class="line">　　findtext(match)：寻找第一个匹配子元素，返回其text值。匹配对象可以为tag或path。</span><br><span class="line">　　insert(index, element)：在指定位置插入子元素。</span><br><span class="line">　　iter(tag=None)：生成遍历当前元素所有后代或者给定tag的后代的迭代器。＃python2.7新特性</span><br><span class="line">　　iterfind(match)：根据tag或path查找所有的后代。</span><br><span class="line">　　itertext()：遍历所有后代并返回text值。</span><br><span class="line">　　remove(subelement)：删除子元素。</span><br><span class="line">　　</span><br><span class="line">　　</span><br><span class="line">attrib        <span class="comment"># 为包含元素属性的字典</span></span><br><span class="line">keys()        <span class="comment"># 返回元素属性名称列表</span></span><br><span class="line">items()       <span class="comment"># 返回(name,value)列表</span></span><br><span class="line">get(key, default=None)     <span class="comment">#获取属性</span></span><br><span class="line"><span class="built_in">set</span>(key, value)                      <span class="comment"># 跟新/添加  属性</span></span><br><span class="line">del xxx.attrib[key]                  <span class="comment"># 删除对应的属性</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="ElementTree-对象"><a href="#ElementTree-对象" class="headerlink" title="ElementTree 对象"></a><strong>ElementTree 对象</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class xml.etree.ElementTree.ElementTree(element=None, file=None)：</span><br><span class="line"></span><br><span class="line">ElementTree是一个包装器类，这个类表示一个完整的元素层次结构，并为标准XML的序列化添加了一些额外的支持。</span><br><span class="line"></span><br><span class="line">1._setroot(element):替换根元素，原来的根元素中的内容会消失。</span><br><span class="line"></span><br><span class="line">2.find(match, namespaces=None):从根元素开始匹配和 Element.find()作用一样。</span><br><span class="line"></span><br><span class="line">3.findall(match, namespaces=None):从根元素开始匹配和 Element.findall()作用一样。</span><br><span class="line"></span><br><span class="line">4.findtext(match, default=None, namespaces=None):从根元素开始匹配和 Element.findtext()作用一样。</span><br><span class="line"></span><br><span class="line">5.getiterator(tag=None):Python3.2后使用 ElementTree.iter() 代替。</span><br><span class="line"></span><br><span class="line">6.iter(tag=None):迭代所有元素</span><br><span class="line"></span><br><span class="line">7.iterfind(match, namespaces=None):从根元素开始匹配和 Element.iterfind()作用一样。</span><br><span class="line"></span><br><span class="line">8.parse(<span class="built_in">source</span>, parser=None):解析xml文本，返回根元素。</span><br><span class="line"></span><br><span class="line">9.write(file, encoding=“us-ascii”, xml_declaration=None, default_namespace=None, method=“xml”, *, short_empty_elements=True):写出XML文本。</span><br></pre></td></tr></table></figure>





<h3 id="示例1-这个很重要，玩懂这个，就差不多了"><a href="#示例1-这个很重要，玩懂这个，就差不多了" class="headerlink" title="示例1 - 这个很重要，玩懂这个，就差不多了"></a>示例1 - 这个很重要，玩懂这个，就差不多了</h3><p>参考：<a href="http://www.zzvips.com/article/91375.html" target="_blank" rel="noopener">详解在Python程序中解析并修改XML内容的方法</a></p>
<h4 id="xml文件"><a href="#xml文件" class="headerlink" title="xml文件"></a>xml文件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># test.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">processers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">processer</span> <span class="attr">name</span>=<span class="string">"AProcesser"</span> <span class="attr">file</span>=<span class="string">"lib64/A.so"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">path</span>=<span class="string">"/tmp"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">processer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">processer</span> <span class="attr">name</span>=<span class="string">"BProcesser"</span> <span class="attr">file</span>=<span class="string">"lib64/B.so"</span> <span class="attr">value</span>=<span class="string">"fordelete"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">processer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">processer</span> <span class="attr">name</span>=<span class="string">"BProcesser"</span> <span class="attr">file</span>=<span class="string">"lib64/B.so2222222"</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">services</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">service</span> <span class="attr">name</span>=<span class="string">"search"</span> <span class="attr">prefix</span>=<span class="string">"/bin/search?"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">output_formatter</span>=<span class="string">"OutPutFormatter:service_inc"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">chain</span> <span class="attr">sequency</span>=<span class="string">"chain1"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">chain</span> <span class="attr">sequency</span>=<span class="string">"chain2"</span>&gt;</span><span class="tag">&lt;/<span class="name">chain</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">service</span> <span class="attr">name</span>=<span class="string">"update"</span> <span class="attr">prefix</span>=<span class="string">"/bin/update?"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">chain</span> <span class="attr">sequency</span>=<span class="string">"chain3"</span> <span class="attr">value</span>=<span class="string">"fordelete"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">services</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">processers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">framework</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python  </span></span><br><span class="line"><span class="comment"># -*- coding=utf-8 -*-  </span></span><br><span class="line"><span class="keyword">from</span> xml.etree.ElementTree <span class="keyword">import</span> ElementTree,Element </span><br><span class="line"><span class="comment">#遍历整个文档树用ElementTree，遍历单独的节点或者子节点用Element </span></span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_xml</span><span class="params">(in_path)</span>:</span>  </span><br><span class="line">    <span class="string">'''''读取并解析xml文件 </span></span><br><span class="line"><span class="string">       in_path: xml路径 </span></span><br><span class="line"><span class="string">       return: ElementTree'''</span>  </span><br><span class="line">    tree = ElementTree()  </span><br><span class="line">    <span class="comment">#prese()解析xml文件</span></span><br><span class="line">    tree.parse(in_path)  </span><br><span class="line">    <span class="keyword">return</span> tree  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_xml</span><span class="params">(tree, out_path)</span>:</span>  </span><br><span class="line">    <span class="string">'''''将xml文件写出 </span></span><br><span class="line"><span class="string">       tree: xml树 </span></span><br><span class="line"><span class="string">       out_path: 写出路径'''</span>  </span><br><span class="line">    tree.write(out_path, encoding=<span class="string">"utf-8"</span>,xml_declaration=<span class="literal">True</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">if_match</span><span class="params">(node, kv_map)</span>:</span>  </span><br><span class="line">    <span class="string">'''''判断某个节点是否包含所有传入参数属性 </span></span><br><span class="line"><span class="string">       node: 节点 </span></span><br><span class="line"><span class="string">       kv_map: 属性及属性值组成的map'''</span>  </span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> kv_map:  </span><br><span class="line">        <span class="keyword">if</span> node.get(key) != kv_map.get(key):  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span>  </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#---------------search -----  </span></span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_nodes</span><span class="params">(tree, path)</span>:</span>  </span><br><span class="line">    <span class="string">'''''查找某个路径匹配的所有节点 </span></span><br><span class="line"><span class="string">       tree: xml树 </span></span><br><span class="line"><span class="string">       path: 节点路径'''</span>  </span><br><span class="line">    <span class="keyword">return</span> tree.findall(path)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_node_by_keyvalue</span><span class="params">(nodelist, kv_map)</span>:</span>  </span><br><span class="line">    <span class="string">'''''根据属性及属性值定位符合的节点，返回节点 </span></span><br><span class="line"><span class="string">       nodelist: 节点列表 </span></span><br><span class="line"><span class="string">       kv_map: 匹配属性及属性值map'''</span>  </span><br><span class="line">    result_nodes = []  </span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> nodelist:  </span><br><span class="line">        <span class="keyword">if</span> if_match(node, kv_map):  </span><br><span class="line">            result_nodes.append(node)  </span><br><span class="line">    <span class="keyword">return</span> result_nodes  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#---------------change -----  </span></span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_node_properties</span><span class="params">(nodelist, kv_map, is_delete=False)</span>:</span>  </span><br><span class="line">    <span class="string">'''''修改/增加 /删除 节点的属性及属性值 </span></span><br><span class="line"><span class="string">       nodelist: 节点列表 </span></span><br><span class="line"><span class="string">       kv_map:属性及属性值map'''</span>  </span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> nodelist:  </span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> kv_map:  </span><br><span class="line">            <span class="keyword">if</span> is_delete:   </span><br><span class="line">                <span class="keyword">if</span> key <span class="keyword">in</span> node.attrib:  </span><br><span class="line">                    <span class="keyword">del</span> node.attrib[key]  </span><br><span class="line">            <span class="keyword">else</span>:  </span><br><span class="line">                node.set(key, kv_map.get(key))  </span><br><span class="line">              </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_node_text</span><span class="params">(nodelist, text, is_add=False, is_delete=False)</span>:</span>  </span><br><span class="line">    <span class="string">'''''改变/增加/删除一个节点的文本 </span></span><br><span class="line"><span class="string">       nodelist:节点列表 </span></span><br><span class="line"><span class="string">       text : 更新后的文本'''</span>  </span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> nodelist:  </span><br><span class="line">        <span class="keyword">if</span> is_add:  </span><br><span class="line">            node.text += text  </span><br><span class="line">        <span class="keyword">elif</span> is_delete:  </span><br><span class="line">            node.text = <span class="string">""</span>  </span><br><span class="line">        <span class="keyword">else</span>:  </span><br><span class="line">            node.text = text  </span><br><span class="line">              </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_node</span><span class="params">(tag, property_map, content)</span>:</span>  </span><br><span class="line">    <span class="string">'''''新造一个节点 </span></span><br><span class="line"><span class="string">       tag:节点标签 </span></span><br><span class="line"><span class="string">       property_map:属性及属性值map </span></span><br><span class="line"><span class="string">       content: 节点闭合标签里的文本内容 </span></span><br><span class="line"><span class="string">       return 新节点'''</span>  </span><br><span class="line">    element = Element(tag, property_map)  </span><br><span class="line">    element.text = content  </span><br><span class="line">    <span class="keyword">return</span> element  </span><br><span class="line">          </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_child_node</span><span class="params">(nodelist, element)</span>:</span>  </span><br><span class="line">    <span class="string">'''''给一个节点添加子节点 </span></span><br><span class="line"><span class="string">       nodelist: 节点列表 </span></span><br><span class="line"><span class="string">       element: 子节点'''</span>  </span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> nodelist:  </span><br><span class="line">        node.append(element)  </span><br><span class="line">          </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_node_by_tagkeyvalue</span><span class="params">(nodelist, tag, kv_map)</span>:</span>  </span><br><span class="line">    <span class="string">'''''同过属性及属性值定位一个节点，并删除之 </span></span><br><span class="line"><span class="string">       nodelist: 父节点列表 </span></span><br><span class="line"><span class="string">       tag:子节点标签 </span></span><br><span class="line"><span class="string">       kv_map: 属性及属性值列表'''</span>  </span><br><span class="line">    <span class="keyword">for</span> parent_node <span class="keyword">in</span> nodelist:  </span><br><span class="line">        children = parent_node.getchildren()  </span><br><span class="line">        <span class="keyword">for</span> child <span class="keyword">in</span> children:  </span><br><span class="line">            <span class="keyword">if</span> child.tag == tag <span class="keyword">and</span> if_match(child, kv_map):  </span><br><span class="line">                parent_node.remove(child)  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_node_by_tagtext</span><span class="params">(self,nodelist, tag, text)</span>:</span>  </span><br><span class="line">        <span class="string">'''''找到当前节点下的子节点中符合tag和text值，匹配，则返回节点,不匹配，返回false</span></span><br><span class="line"><span class="string">        nodelist: 父节点列表 </span></span><br><span class="line"><span class="string">        tag:子节点标签 </span></span><br><span class="line"><span class="string">        text: 文本'''</span>  </span><br><span class="line">        <span class="keyword">for</span> parent_node <span class="keyword">in</span> nodelist:  </span><br><span class="line">            children = parent_node.getchildren()  </span><br><span class="line">            <span class="keyword">for</span> child <span class="keyword">in</span> children: </span><br><span class="line">                <span class="comment">#print(child.tag,':',child.text) </span></span><br><span class="line">                <span class="keyword">if</span> child.tag == tag <span class="keyword">and</span> child.text == text:  </span><br><span class="line">                    <span class="keyword">return</span> child</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">#1. 读取xml文件  </span></span><br><span class="line">    <span class="comment">#./表示当前目录，或者不用，直接当前目录下文件名</span></span><br><span class="line">    tree = read_xml(<span class="string">"test.xml"</span>)  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">#2. 属性修改  </span></span><br><span class="line">      <span class="comment">#A. 找到父节点  </span></span><br><span class="line">    nodes = find_nodes(tree, <span class="string">"processers/processer"</span>)  </span><br><span class="line">      <span class="comment">#B. 通过属性准确定位子节点  </span></span><br><span class="line">    result_nodes = get_node_by_keyvalue(nodes, &#123;<span class="string">"name"</span>:<span class="string">"BProcesser"</span>&#125;)  </span><br><span class="line">      <span class="comment">#C. 修改节点属性  </span></span><br><span class="line">    change_node_properties(result_nodes, &#123;<span class="string">"age"</span>: <span class="string">"1"</span>&#125;)  </span><br><span class="line">      <span class="comment">#D. 删除节点属性  </span></span><br><span class="line">    change_node_properties(result_nodes, &#123;<span class="string">"value"</span>:<span class="string">""</span>&#125;, <span class="literal">True</span>)  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">#3. 节点修改  </span></span><br><span class="line">      <span class="comment">#A.新建节点  </span></span><br><span class="line">    a = create_node(<span class="string">"person"</span>, &#123;<span class="string">"age"</span>:<span class="string">"15"</span>,<span class="string">"money"</span>:<span class="string">"200000"</span>&#125;, <span class="string">"this is the firest content"</span>)  </span><br><span class="line">      <span class="comment">#B.插入到父节点之下  </span></span><br><span class="line">    add_child_node(result_nodes, a)  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">#4. 删除节点  </span></span><br><span class="line">       <span class="comment">#定位父节点  </span></span><br><span class="line">    del_parent_nodes = find_nodes(tree, <span class="string">"processers/services/service"</span>)  </span><br><span class="line">       <span class="comment">#准确定位子节点并删除之  </span></span><br><span class="line">    target_del_node = del_node_by_tagkeyvalue(del_parent_nodes, <span class="string">"chain"</span>, &#123;<span class="string">"sequency"</span> : <span class="string">"chain1"</span>&#125;)  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">#5. 修改节点文本  </span></span><br><span class="line">       <span class="comment">#定位节点  </span></span><br><span class="line">    text_nodes = get_node_by_keyvalue(find_nodes(tree, <span class="string">"processers/services/service/chain"</span>), &#123;<span class="string">"sequency"</span>:<span class="string">"chain3"</span>&#125;)  </span><br><span class="line">    change_node_text(text_nodes, <span class="string">"new text"</span>)  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">#6. 输出到结果文件  </span></span><br><span class="line">    write_xml(tree, <span class="string">"./out.xml"</span>)</span><br></pre></td></tr></table></figure>



<h3 id="示例2"><a href="#示例2" class="headerlink" title="示例2"></a>示例2</h3><h4 id="1-读取和解析xml文件"><a href="#1-读取和解析xml文件" class="headerlink" title="1 读取和解析xml文件"></a><strong>1 读取和解析xml文件</strong></h4><p>支持遍历结点，查找结点和访问结点</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    </span><br><span class="line">def element_read_xml(xml_path):</span><br><span class="line"></span><br><span class="line">    <span class="comment">#1. 获取root结点</span></span><br><span class="line">    tree = ET.parse(xml_path)   <span class="comment">#方式一</span></span><br><span class="line">    root = tree.getroot()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># tree = ET.ElementTree(file=xml_path)  # 方式二</span></span><br><span class="line">    <span class="comment"># root = tree.getroot()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># with open(xml_path, "r", encoding="utf-8") as f:   # 方式三</span></span><br><span class="line">    <span class="comment">#     root = ET.fromstring(f.read())</span></span><br><span class="line">    <span class="built_in">print</span>(root)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#2.访问特定结点属性  (属性包括tag, text, attrib)</span></span><br><span class="line">    <span class="comment">#遍历结点, 每一个结点都是一个迭代器，能遍历其子节点</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> root:</span><br><span class="line">        <span class="built_in">print</span>(i.tag, i.attrib)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">            <span class="built_in">print</span>(j, j.attrib)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#3.下标方式访问子节点</span></span><br><span class="line">    <span class="built_in">print</span>(root[0].tag, root[0].attrib, root[0].text)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#4. 查找结点，支持tag名字和xpath语法</span></span><br><span class="line">    <span class="built_in">print</span>(tree.find(<span class="string">"folder"</span>))  <span class="comment">#在当前结点的子节点中寻找标签为folder的子节点</span></span><br><span class="line">    <span class="built_in">print</span>(tree.find(<span class="string">".//name"</span>)) <span class="comment">#寻找所有子孙结点中第一个标签为name的子节点</span></span><br><span class="line">    <span class="built_in">print</span>(tree.findall(<span class="string">".//name"</span>))  <span class="comment">#寻找所有子孙结点中标签为name的子节点（返回列表）</span></span><br><span class="line">    <span class="built_in">print</span>(tree.findtext(<span class="string">".//name"</span>))  <span class="comment">#寻找所有子孙结点中第一个标签为name的子节点，并返回其text属性</span></span><br></pre></td></tr></table></figure>

<h4 id="2-创建xml文件并写入"><a href="#2-创建xml文件并写入" class="headerlink" title="2 创建xml文件并写入"></a><strong>2 创建xml文件并写入</strong></h4><p>需要创建根结点，然后添加子节点，最后创建节点树并写入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">def write_xml():</span><br><span class="line">    root = ET.Element(<span class="string">"node"</span>)</span><br><span class="line">    folder_node = ET.Element(<span class="string">"folder"</span>)</span><br><span class="line">    folder_node.text = <span class="string">"/home"</span></span><br><span class="line">    folder_node.tail = <span class="string">"\n"</span></span><br><span class="line">    <span class="built_in">print</span>(dir(folder_node))</span><br><span class="line">    root.append(folder_node)   <span class="comment">#添加子节点</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#extend(subments) #添加多个子节点</span></span><br><span class="line">    elem3 = ET.Element(<span class="string">"test_extend"</span>)</span><br><span class="line">    elem3.text = <span class="string">"elem 3"</span></span><br><span class="line">    elem3.tail = <span class="string">"\n"</span>      <span class="comment">#结点尾部添加换行</span></span><br><span class="line">    elem4 = ET.Element(<span class="string">"test_extend"</span>)</span><br><span class="line">    elem4.text = <span class="string">"elem 4"</span></span><br><span class="line">    elem4.tail = <span class="string">"\n"</span></span><br><span class="line">    root.extend([elem3, elem4])</span><br><span class="line">    <span class="comment">#insert(index, subment)  #插入子节点</span></span><br><span class="line">    <span class="comment">#remove(subment)      #删除子节点</span></span><br><span class="line"></span><br><span class="line">    folder_node = ET.SubElement(root, <span class="string">"folder"</span>)  <span class="comment"># 为root添加子节点</span></span><br><span class="line">    folder_node.text = <span class="string">"/home"</span></span><br><span class="line"></span><br><span class="line">    tree = ET.ElementTree(root)</span><br><span class="line">    tree.write(<span class="string">"output.xml"</span>, encoding=<span class="string">"utf-8"</span>, xml_declaration=True)  <span class="comment">#保存时无缩进，添加缩进需要借用dom</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#借用dom，添加缩进</span></span><br><span class="line">    <span class="comment"># rawtext = ET.tostring(root)</span></span><br><span class="line">    <span class="comment"># dom = minidom.parseString(rawtext)</span></span><br><span class="line">    <span class="comment"># with open("output.xml", "w") as f:</span></span><br><span class="line">    <span class="comment">#     dom.writexml(f, indent="\t", newl="", encoding="utf-8")</span></span><br></pre></td></tr></table></figure>

<h4 id="3-读取并更新结点"><a href="#3-读取并更新结点" class="headerlink" title="3 读取并更新结点"></a><strong>3 读取并更新结点</strong></h4><p>除了下面修改结点的名称外，还可以进行添加子节点，删除子节点等操作</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def update_xml():</span><br><span class="line">    <span class="comment">#查找节点并更新</span></span><br><span class="line">    root = ET.parse(<span class="string">"output.xml"</span>)</span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> root.findall(<span class="string">".//folder"</span>):</span><br><span class="line">        <span class="keyword">if</span> node.text == <span class="string">"/home"</span>:</span><br><span class="line">            node.tag = <span class="string">"path"</span></span><br><span class="line">    ET.dump(root)  <span class="comment">#打印xml</span></span><br><span class="line">    root.write(<span class="string">"output.xml"</span>)</span><br></pre></td></tr></table></figure>

<h4 id="4-添加子元素"><a href="#4-添加子元素" class="headerlink" title="4 添加子元素"></a>4 添加子元素</h4><ul>
<li><code>append</code>(<em>subelement</em>) </li>
<li><code>extend</code>(<em>subelements</em>)</li>
<li><code>insert</code>(<em>index</em>, <em>element</em>)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># country.xml</span></span><br><span class="line">&lt;?xml version=<span class="string">"1.0"</span>?&gt;</span><br><span class="line">&lt;data&gt;</span><br><span class="line">    &lt;country name=<span class="string">"Liechtenstein"</span>&gt;</span><br><span class="line">        &lt;rank updated=<span class="string">"yes"</span>&gt;2&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;2008&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;141100&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Austria"</span> direction=<span class="string">"E"</span>/&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Switzerland"</span> direction=<span class="string">"W"</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">    &lt;country name=<span class="string">"Singapore"</span>&gt;</span><br><span class="line">        &lt;rank updated=<span class="string">"yes"</span>&gt;5&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;2011&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;59900&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Malaysia"</span> direction=<span class="string">"N"</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">    &lt;country name=<span class="string">"Panama"</span>&gt;</span><br><span class="line">        &lt;rank updated=<span class="string">"yes"</span>&gt;69&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;2011&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;13600&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Costa Rica"</span> direction=<span class="string">"W"</span>/&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Colombia"</span> direction=<span class="string">"E"</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">&lt;/data&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line">tree = ET.parse(<span class="string">"country.xml"</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">country = root[<span class="number">0</span>]</span><br><span class="line">last_ele = country[len(list(country))<span class="number">-1</span>]</span><br><span class="line">last_ele.tail = <span class="string">'\n\t\t'</span></span><br><span class="line"><span class="comment"># 创建新的元素, tag为test_append</span></span><br><span class="line">elem1 = ET.Element(<span class="string">"test_append"</span>)</span><br><span class="line">elem1.text = <span class="string">"elem 1"</span></span><br><span class="line"><span class="comment"># elem.tail = '\n\t'</span></span><br><span class="line">country.append(elem1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># SubElement() 其实内部调用的时append()</span></span><br><span class="line">elem2 = ET.SubElement(country, <span class="string">"test_subelement"</span>)</span><br><span class="line">elem2.text = <span class="string">"elem 2"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># extend()</span></span><br><span class="line">elem3 = ET.Element(<span class="string">"test_extend"</span>)</span><br><span class="line">elem3.text = <span class="string">"elem 3"</span></span><br><span class="line">elem4 = ET.Element(<span class="string">"test_extend"</span>)</span><br><span class="line">elem4.text = <span class="string">"elem 4"</span></span><br><span class="line">country.extend([elem3, elem4])</span><br><span class="line"></span><br><span class="line"><span class="comment"># insert()</span></span><br><span class="line">elem5 = ET.Element(<span class="string">"test_insert"</span>)</span><br><span class="line">elem5.text = <span class="string">"elem 5"</span></span><br><span class="line">country.insert(<span class="number">5</span>, elem5)</span><br><span class="line"></span><br><span class="line">ET.dump(country)</span><br></pre></td></tr></table></figure>

<h4 id="5-删除子元素"><a href="#5-删除子元素" class="headerlink" title="5 删除子元素"></a>5 删除子元素</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line">tree = ET.parse(<span class="string">"country.xml"</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除rank大于50的国家</span></span><br><span class="line"><span class="keyword">for</span> country <span class="keyword">in</span> root.iter(<span class="string">"country"</span>):</span><br><span class="line">    rank = int(country.find(<span class="string">"rank"</span>).text)</span><br><span class="line">    <span class="keyword">if</span> rank &gt; <span class="number">50</span>:</span><br><span class="line">        <span class="comment"># remove()方法 删除子元素</span></span><br><span class="line">        root.remove(country)</span><br><span class="line"></span><br><span class="line">ET.dump(root)</span><br></pre></td></tr></table></figure>

<h3 id="示例3"><a href="#示例3" class="headerlink" title="示例3"></a>示例3</h3><h4 id="xml文件-1"><a href="#xml文件-1" class="headerlink" title="xml文件"></a>xml文件</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0"?&gt;</span><br><span class="line">&lt;data&gt;</span><br><span class="line">    &lt;country name=<span class="string">"Liechtenstein"</span>&gt;</span><br><span class="line">        &lt;rank&gt;1&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;2008&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;141100&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Austria"</span> direction=<span class="string">"E"</span>/&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Switzerland"</span> direction=<span class="string">"W"</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">    &lt;country name=<span class="string">"Singapore"</span>&gt;</span><br><span class="line">        &lt;rank&gt;4&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;2011&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;59900&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Malaysia"</span> direction=<span class="string">"N"</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">    &lt;country name=<span class="string">"Panama"</span>&gt;</span><br><span class="line">        &lt;rank&gt;68&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;2011&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;13600&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Costa Rica"</span> direction=<span class="string">"W"</span>/&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Colombia"</span> direction=<span class="string">"E"</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">&lt;/data&gt;</span><br></pre></td></tr></table></figure>

<h4 id="操作-1"><a href="#操作-1" class="headerlink" title="操作"></a>操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过读取文件来导入这些数据</span></span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line">tree = ET.parse(<span class="string">'country_data.xml'</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"></span><br><span class="line"><span class="comment">#作为一个元素，root有一个标签和一个属性字典:</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>root.tag</span><br><span class="line"><span class="string">'data'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>root.attrib</span><br><span class="line">&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 它也有子节点，我们可以迭代:</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> child <span class="keyword">in</span> root:</span><br><span class="line"><span class="meta">... </span>    print(child.tag, child.attrib)</span><br><span class="line">...</span><br><span class="line">country &#123;<span class="string">'name'</span>: <span class="string">'Liechtenstein'</span>&#125;</span><br><span class="line">country &#123;<span class="string">'name'</span>: <span class="string">'Singapore'</span>&#125;</span><br><span class="line">country &#123;<span class="string">'name'</span>: <span class="string">'Panama'</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 孩子节点是嵌套的，我们可以通过索引访问特定的子节点</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>root[<span class="number">0</span>][<span class="number">1</span>].text</span><br><span class="line"><span class="string">'2008'</span></span><br></pre></td></tr></table></figure>

<h4 id="获取XML中的元素"><a href="#获取XML中的元素" class="headerlink" title="获取XML中的元素"></a>获取XML中的元素</h4><p>Element有一些有用的方法，可以帮助递归地遍历它下面的所有子树(它的子树，它们的子树，等等)比如：Element.iter():</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> neighbor <span class="keyword">in</span> root.iter(<span class="string">'neighbor'</span>):</span><br><span class="line"><span class="meta">... </span>    print(neighbor.attrib)</span><br><span class="line">...</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="string">'Austria'</span>, <span class="string">'direction'</span>: <span class="string">'E'</span>&#125;</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="string">'Switzerland'</span>, <span class="string">'direction'</span>: <span class="string">'W'</span>&#125;</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="string">'Malaysia'</span>, <span class="string">'direction'</span>: <span class="string">'N'</span>&#125;</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="string">'Costa Rica'</span>, <span class="string">'direction'</span>: <span class="string">'W'</span>&#125;</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="string">'Colombia'</span>, <span class="string">'direction'</span>: <span class="string">'E'</span>&#125;</span><br></pre></td></tr></table></figure>

<h4 id="解析XML名称空间"><a href="#解析XML名称空间" class="headerlink" title="解析XML名称空间"></a>解析XML名称空间</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这里有一个XML示例它包含两个名称空间，一个是前缀“ fictional”另一个是默认的名称空间:</span></span><br><span class="line">&lt;?xml version="1.0"?&gt;</span><br><span class="line">&lt;actors xmlns:fictional=<span class="string">"http://characters.example.com"</span></span><br><span class="line">        xmlns=<span class="string">"http://people.example.com"</span>&gt;</span><br><span class="line">    &lt;actor&gt;</span><br><span class="line">        &lt;name&gt;John Cleese&lt;/name&gt;</span><br><span class="line">        &lt;fictional:character&gt;Lancelot&lt;/fictional:character&gt;</span><br><span class="line">        &lt;fictional:character&gt;Archie Leach&lt;/fictional:character&gt;</span><br><span class="line">    &lt;/actor&gt;</span><br><span class="line">    &lt;actor&gt;</span><br><span class="line">        &lt;name&gt;Eric Idle&lt;/name&gt;</span><br><span class="line">        &lt;fictional:character&gt;Sir Robin&lt;/fictional:character&gt;</span><br><span class="line">        &lt;fictional:character&gt;Gunther&lt;/fictional:character&gt;</span><br><span class="line">        &lt;fictional:character&gt;Commander Clement&lt;/fictional:character&gt;</span><br><span class="line">    &lt;/actor&gt;</span><br><span class="line">&lt;/actors&gt;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 搜索名称空间XML示例的更好方法是使用自己的前缀创建字典，并在搜索函数中使用这些前缀</span></span><br><span class="line">ns = &#123;<span class="string">'real_person'</span>: <span class="string">'http://people.example.com'</span>,</span><br><span class="line">      <span class="string">'role'</span>: <span class="string">'http://characters.example.com'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> actor <span class="keyword">in</span> root.findall(<span class="string">'real_person:actor'</span>, ns):</span><br><span class="line">    name = actor.find(<span class="string">'real_person:name'</span>, ns)</span><br><span class="line">    print(name.text)</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> actor.findall(<span class="string">'role:character'</span>, ns):</span><br><span class="line">        print(<span class="string">' |--&gt;'</span>, char.text)</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出结果：</span></span><br><span class="line"></span><br><span class="line">John Cleese</span><br><span class="line"> |--&gt; Lancelot</span><br><span class="line"> |--&gt; Archie Leach</span><br><span class="line">Eric Idle</span><br><span class="line"> |--&gt; Sir Robin</span><br><span class="line"> |--&gt; Gunther</span><br><span class="line"> |--&gt; Commander Clement</span><br></pre></td></tr></table></figure>



<h2 id="三、SAX-Simple-API-for-XML"><a href="#三、SAX-Simple-API-for-XML" class="headerlink" title="三、SAX(Simple API for XML)"></a>三、<strong>SAX(Simple API for XML)</strong></h2><p>SAX是一种基于事件的流式处理模型，可以在只读入部分XML的情况下进行处理, 比较快，占用内存少。</p>
<ul>
<li>DOM与etree一般都比SAX简单, 但其将XML数据映射到内存中的树，比较慢，且较耗内存；</li>
<li>如果XML文件比较大，或要求速度快时，SAX比较适合；</li>
</ul>
<p><strong>利用SAX解析XML文档牵涉到两个部分</strong>:<code>解析器和事件处理器</code></p>
<ul>
<li>解析器负责读取XML文档,并向事件处理器发送事件,如元素开始跟元素结束事件；</li>
<li>而事件处理器则负责对事件作出相应,对传递的XML数据进行处理</li>
</ul>
<h3 id="解析器"><a href="#解析器" class="headerlink" title="解析器"></a><strong>解析器</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建解析器</span></span><br><span class="line"><span class="comment">#1</span></span><br><span class="line">xml.sax.parse( xmlfile, contenthandler[, errorhandler])</span><br><span class="line">xmlfile - xml文件名</span><br><span class="line">contenthandler - 必须是一个ContentHandler的对象</span><br><span class="line">errorhandler - 如果指定该参数，errorhandler必须是一个SAX ErrorHandler对象</span><br><span class="line"></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line">xml.sax.parseString(xmlstring, contenthandler[, errorhandler])</span><br><span class="line">xmlstring - xml字符串</span><br><span class="line">contenthandler - 必须是一个ContentHandler的对象</span><br><span class="line">errorhandler - 如果指定该参数，errorhandler必须是一个SAX ErrorHandler对象</span><br><span class="line"></span><br><span class="line"><span class="comment">#3</span></span><br><span class="line">xml.sax.make_parser()</span><br></pre></td></tr></table></figure>

<h3 id="事件处理器"><a href="#事件处理器" class="headerlink" title="事件处理器"></a><strong>事件处理器</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">class EventHandler(sax.ContentHandler):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    <span class="comment">#文档启动的时候调用</span></span><br><span class="line">    def startDocument(self):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    <span class="comment">#解析器到达文档结尾时调用</span></span><br><span class="line">    def endDocument(self):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 遇到XML开始标签时调用，name是标签的名字，attrs是标签的属性值字典。</span></span><br><span class="line">    def startElement(self, name, attrs):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    <span class="comment">#遇到XML结束标签时调用。</span></span><br><span class="line">    def endElement(self, tag):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    <span class="comment">#标签之间的内容处理时调用</span></span><br><span class="line">    def characters(self, content):</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure>

<h3 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line">import xml.sax</span><br><span class="line"></span><br><span class="line">class MovieHandler( xml.sax.ContentHandler ):</span><br><span class="line">   def __init__(self):</span><br><span class="line">​      self.CurrentData = <span class="string">""</span></span><br><span class="line">​      self.type = <span class="string">""</span></span><br><span class="line">​      self.format = <span class="string">""</span></span><br><span class="line">​      self.year = <span class="string">""</span></span><br><span class="line">​      self.rating = <span class="string">""</span></span><br><span class="line">​      self.stars = <span class="string">""</span></span><br><span class="line">​      self.description = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># 元素开始事件处理</span></span><br><span class="line">   def startElement(self, tag, attributes):</span><br><span class="line">​      self.CurrentData = tag</span><br><span class="line">​      <span class="keyword">if</span> tag == <span class="string">"movie"</span>:</span><br><span class="line">​         <span class="built_in">print</span> <span class="string">"*****Movie*****"</span></span><br><span class="line">​         title = attributes[<span class="string">"title"</span>]</span><br><span class="line">​         <span class="built_in">print</span> <span class="string">"Title:"</span>, title</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 元素结束事件处理</span></span><br><span class="line">   def endElement(self, tag):</span><br><span class="line">​      <span class="keyword">if</span> self.CurrentData == <span class="string">"type"</span>:</span><br><span class="line">​         <span class="built_in">print</span> <span class="string">"Type:"</span>, self.type</span><br><span class="line">​      <span class="keyword">elif</span> self.CurrentData == <span class="string">"format"</span>:</span><br><span class="line">​         <span class="built_in">print</span> <span class="string">"Format:"</span>, self.format</span><br><span class="line">​      <span class="keyword">elif</span> self.CurrentData == <span class="string">"year"</span>:</span><br><span class="line">​         <span class="built_in">print</span> <span class="string">"Year:"</span>, self.year</span><br><span class="line">​      <span class="keyword">elif</span> self.CurrentData == <span class="string">"rating"</span>:</span><br><span class="line">​         <span class="built_in">print</span> <span class="string">"Rating:"</span>, self.rating</span><br><span class="line">​      <span class="keyword">elif</span> self.CurrentData == <span class="string">"stars"</span>:</span><br><span class="line">​         <span class="built_in">print</span> <span class="string">"Stars:"</span>, self.stars</span><br><span class="line">​      <span class="keyword">elif</span> self.CurrentData == <span class="string">"description"</span>:</span><br><span class="line">​         <span class="built_in">print</span> <span class="string">"Description:"</span>, self.description</span><br><span class="line">​      self.CurrentData = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># 内容事件处理</span></span><br><span class="line">   def characters(self, content):</span><br><span class="line">​      <span class="keyword">if</span> self.CurrentData == <span class="string">"type"</span>:</span><br><span class="line">​         self.type = content</span><br><span class="line">​      <span class="keyword">elif</span> self.CurrentData == <span class="string">"format"</span>:</span><br><span class="line">​         self.format = content</span><br><span class="line">​      <span class="keyword">elif</span> self.CurrentData == <span class="string">"year"</span>:</span><br><span class="line">​         self.year = content</span><br><span class="line">​      <span class="keyword">elif</span> self.CurrentData == <span class="string">"rating"</span>:</span><br><span class="line">​         self.rating = content</span><br><span class="line">​      <span class="keyword">elif</span> self.CurrentData == <span class="string">"stars"</span>:</span><br><span class="line">​         self.stars = content</span><br><span class="line">​      <span class="keyword">elif</span> self.CurrentData == <span class="string">"description"</span>:</span><br><span class="line">​         self.description = content</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( __name__ == <span class="string">"__main__"</span>):</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 创建一个 XMLReader</span></span><br><span class="line">   parser = xml.sax.make_parser()</span><br><span class="line">   <span class="comment"># turn off namepsaces</span></span><br><span class="line">   parser.setFeature(xml.sax.handler.feature_namespaces, 0)</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 重写 ContextHandler</span></span><br><span class="line">   Handler = MovieHandler()</span><br><span class="line">   parser.setContentHandler( Handler )</span><br><span class="line"></span><br><span class="line">   parser.parse(<span class="string">"movies.xml"</span>)</span><br></pre></td></tr></table></figure>



<blockquote>
<p>参考:</p>
<p><a href="https://www.cnblogs.com/silence-cho/p/12542747.html" target="_blank" rel="noopener">python读取，写入和更新xml文件</a></p>
<p><a href="https://www.cnblogs.com/hupeng1234/p/7262371.html" target="_blank" rel="noopener">python 使用ElementTree解析xml</a></p>
<p><a href="https://blog.csdn.net/weixin_36279318/article/details/79176475" target="_blank" rel="noopener">Python xml.etree.ElementTree解析XML文件</a></p>
</blockquote>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Gkon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://gxkon.top/posts/ec4e7dd/">http://gxkon.top/posts/ec4e7dd/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://gxkon.top" target="_blank">Gxkon's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a></div><div class="post_share"><div class="social-share" data-image="https://pic-1256641195.cos.ap-nanjing.myqcloud.com/2020/10/7/68coffee-5567269_1280.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/posts/aea9dc89/"><img class="prev_cover" data-src="/Pic/post.jpg" onerror="onerror=null;src='/Pic/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Python文本处理之PDF操作</div></div></a></div><div class="next-post pull_right"><a href="/posts/ebbbbbf7/"><img class="next_cover" data-src="/Pic/post.jpg" onerror="onerror=null;src='/Pic/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">试玩IPv6与DDNS</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/posts/ffb5fdc7/" title="Python GUI编程(Tkinter)"><img class="relatedPosts_cover" data-src="https://pic-1256641195.cos.ap-nanjing.myqcloud.com/2020/09/night-4011992_1280.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-09-24</div><div class="relatedPosts_title">Python GUI编程(Tkinter)</div></div></a></div><div class="relatedPosts_item"><a href="/posts/1ed47f5b/" title="Python基础之列表"><img class="relatedPosts_cover" data-src="https://tvax3.sinaimg.cn/large/4a9e9735gy1gdait9noiwj24802diqp3.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-28</div><div class="relatedPosts_title">Python基础之列表</div></div></a></div><div class="relatedPosts_item"><a href="/posts/f1154067/" title="Python基础之库、Pip、Pypi"><img class="relatedPosts_cover" data-src="https://pic-1256641195.cos.ap-nanjing.myqcloud.com/2020/09/norway-4970081_1280.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-05-28</div><div class="relatedPosts_title">Python基础之库、Pip、Pypi</div></div></a></div><div class="relatedPosts_item"><a href="/posts/49a688a0/" title="Python基础之字符串"><img class="relatedPosts_cover" data-src="https://tvax3.sinaimg.cn/large/4a9e9735gy1gdaiuzfg25j24002o0b29.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-28</div><div class="relatedPosts_title">Python基础之字符串</div></div></a></div><div class="relatedPosts_item"><a href="/posts/bbbc4a2f/" title="Python基础之安装与部署"><img class="relatedPosts_cover" data-src="https://pic-1256641195.cos.ap-nanjing.myqcloud.com/2020/09/geyser-4766105_1280.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-05-27</div><div class="relatedPosts_title">Python基础之安装与部署</div></div></a></div><div class="relatedPosts_item"><a href="/posts/dcbec147/" title="Python中级之Pyinstaller打包成exe"><img class="relatedPosts_cover" data-src="/Pic/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-11-07</div><div class="relatedPosts_title">Python中级之Pyinstaller打包成exe</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '1ce3148e3133bf004c96',
  clientSecret: '2a1e5c0f4d38387460b916843bfe5cac67ef2d07',
  repo: 'blankwz.github.io',
  owner: 'blankwz',
  admin: ['blankwz'],
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN',
  perPage: 10,
  distractionFreeMode: false,
  pagerDirection: 'last',
  createIssueManually: false,
  updateCountCallback: commentCount
})
gitalk.render('gitalk-container')

function commentCount(n){
  try {
    document.getElementsByClassName('gitalk-comment-count')[0].innerHTML= n
  } catch (e) {
    return false
  }
}</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Gkon</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">簡</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/third-party/ClickShowText.js"></script></body></html>